<!DOCTYPE html>
<html>
<head>
    <title>AnnotateShot ìœ ë‹› í…ŒìŠ¤íŠ¸</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-result { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .pass { background-color: #d4edda; color: #155724; }
        .fail { background-color: #f8d7da; color: #721c24; }
        .test-summary { margin-top: 20px; font-weight: bold; }
    </style>
</head>
<body>
    <h1>ğŸ§ª AnnotateShot ìœ ë‹› í…ŒìŠ¤íŠ¸</h1>
    <p>AnnotateShot ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ í•µì‹¬ ê¸°ëŠ¥ë“¤ì— ëŒ€í•œ ìœ ë‹› í…ŒìŠ¤íŠ¸ì…ë‹ˆë‹¤.</p>
    
    <button onclick="runAllTests()">í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
    
    <div id="test-results"></div>
    
    <script>
        // í…ŒìŠ¤íŠ¸í•  í•¨ìˆ˜ë“¤ (main.jsì—ì„œ ë¶„ë¦¬ëœ ìˆœìˆ˜ í•¨ìˆ˜ë“¤)
        function calculateImageDimensions(width, height, mode) {
            switch(mode) {
                case 'scale50':
                    return { width: Math.floor(width * 0.5), height: Math.floor(height * 0.5) };
                case 'scale30':
                    return { width: Math.floor(width * 0.3), height: Math.floor(height * 0.3) };
                case 'original':
                    return { width, height };
                default:
                    // Auto resize logic (simplified)
                    const maxWidth = 1400;
                    const maxHeight = 900;
                    if (width > maxWidth || height > maxHeight) {
                        const scale = Math.min(maxWidth / width, maxHeight / height);
                        return { 
                            width: Math.floor(width * scale), 
                            height: Math.floor(height * scale) 
                        };
                    }
                    return { width, height };
            }
        }
        
        function getColorFromSelector(colorValue) {
            const colorMap = {
                'red': '#FF0000',
                'blue': '#0000FF',
                'green': '#00FF00'
            };
            return colorMap[colorValue] || colorValue;
        }
        
        function translateText(key, lang = 'ko') {
            const translations = {
                ko: { save: 'ì €ì¥í•˜ê¸°', undo: 'ë’¤ë¡œê°€ê¸°', red: 'ë¹¨ê°„ìƒ‰', blue: 'íŒŒë€ìƒ‰', green: 'ì´ˆë¡ìƒ‰' },
                en: { save: 'Save', undo: 'Undo', red: 'Red', blue: 'Blue', green: 'Green' }
            };
            return translations[lang]?.[key] || key;
        }
        
        function validateAnnotationClick(click) {
            if (!click || typeof click !== 'object') return false;
            if (!click.type || typeof click.type !== 'string') return false;
            if (typeof click.x !== 'number' || typeof click.y !== 'number') return false;
            if (click.x < 0 || click.y < 0) return false;
            return true;
        }
        
        function calculateNumberPosition(x, y, size) {
            const sizeMap = { small: 20, medium: 30, large: 40 };
            const radius = sizeMap[size] || 30;
            return { 
                centerX: x, 
                centerY: y, 
                radius: radius 
            };
        }
        
        function isValidColor(color) {
            if (!color || typeof color !== 'string') return false;
            // Hex color validation
            if (color.startsWith('#')) {
                return /^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(color);
            }
            // Named colors
            const validColors = ['red', 'blue', 'green', 'yellow', 'black', 'white'];
            return validColors.includes(color.toLowerCase());
        }

        // ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬
        class SimpleTestRunner {
            constructor() {
                this.tests = [];
                this.results = [];
            }
            
            test(name, testFunction) {
                this.tests.push({ name, testFunction });
            }
            
            expect(actual) {
                return {
                    toBe: (expected) => {
                        if (actual !== expected) {
                            throw new Error(`Expected ${expected}, but got ${actual}`);
                        }
                    },
                    toEqual: (expected) => {
                        if (JSON.stringify(actual) !== JSON.stringify(expected)) {
                            throw new Error(`Expected ${JSON.stringify(expected)}, but got ${JSON.stringify(actual)}`);
                        }
                    },
                    toBeTrue: () => {
                        if (actual !== true) {
                            throw new Error(`Expected true, but got ${actual}`);
                        }
                    },
                    toBeFalse: () => {
                        if (actual !== false) {
                            throw new Error(`Expected false, but got ${actual}`);
                        }
                    },
                    toContain: (expected) => {
                        if (!actual || !actual.includes || !actual.includes(expected)) {
                            throw new Error(`Expected ${actual} to contain ${expected}`);
                        }
                    }
                };
            }
            
            run() {
                this.results = [];
                let passed = 0;
                let failed = 0;
                
                this.tests.forEach(({ name, testFunction }) => {
                    try {
                        testFunction();
                        this.results.push({ name, status: 'pass', error: null });
                        passed++;
                    } catch (error) {
                        this.results.push({ name, status: 'fail', error: error.message });
                        failed++;
                    }
                });
                
                return { passed, failed, results: this.results };
            }
        }
        
        // í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë“¤
        const runner = new SimpleTestRunner();
        
        runner.test('ì´ë¯¸ì§€ 50% ì¶•ì†Œ ê³„ì‚°', () => {
            const result = calculateImageDimensions(1000, 800, 'scale50');
            runner.expect(result).toEqual({ width: 500, height: 400 });
        });
        
        runner.test('ì´ë¯¸ì§€ 30% ì¶•ì†Œ ê³„ì‚°', () => {
            const result = calculateImageDimensions(1000, 800, 'scale30');
            runner.expect(result).toEqual({ width: 300, height: 240 });
        });
        
        runner.test('ì›ë³¸ í¬ê¸° ìœ ì§€', () => {
            const result = calculateImageDimensions(800, 600, 'original');
            runner.expect(result).toEqual({ width: 800, height: 600 });
        });
        
        runner.test('ìë™ ë¦¬ì‚¬ì´ì¦ˆ - í° ì´ë¯¸ì§€', () => {
            const result = calculateImageDimensions(2000, 1500, 'auto');
            // 1400x900 ë²”ìœ„ ë‚´ë¡œ ì¶•ì†Œë˜ì–´ì•¼ í•¨
            runner.expect(result.width <= 1400).toBe(true);
            runner.expect(result.height <= 900).toBe(true);
        });
        
        runner.test('ìƒ‰ìƒ ë³€í™˜ - red', () => {
            const result = getColorFromSelector('red');
            runner.expect(result).toBe('#FF0000');
        });
        
        runner.test('ë²ˆì—­ - í•œêµ­ì–´ ì €ì¥', () => {
            const result = translateText('save', 'ko');
            runner.expect(result).toBe('ì €ì¥í•˜ê¸°');
        });
        
        runner.test('ë²ˆì—­ - ì˜ì–´ ì €ì¥', () => {
            const result = translateText('save', 'en');
            runner.expect(result).toBe('Save');
        });
        
        runner.test('ë²ˆì—­ - ì¡´ì¬í•˜ì§€ ì•ŠëŠ” í‚¤', () => {
            const result = translateText('nonexistent', 'ko');
            runner.expect(result).toBe('nonexistent');
        });
        
        runner.test('ìƒ‰ìƒ ë³€í™˜ - blue', () => {
            const result = getColorFromSelector('blue');
            runner.expect(result).toBe('#0000FF');
        });
        
        runner.test('ìƒ‰ìƒ ë³€í™˜ - ì‚¬ìš©ì ì •ì˜ ìƒ‰ìƒ', () => {
            const result = getColorFromSelector('#FF5500');
            runner.expect(result).toBe('#FF5500');
        });
        
        runner.test('ì–´ë…¸í…Œì´ì…˜ í´ë¦­ ê²€ì¦ - ìœ íš¨í•œ ë°ì´í„°', () => {
            const click = { type: 'number', x: 100, y: 200, color: 'red' };
            runner.expect(validateAnnotationClick(click)).toBeTrue();
        });
        
        runner.test('ì–´ë…¸í…Œì´ì…˜ í´ë¦­ ê²€ì¦ - ì˜ëª»ëœ ì¢Œí‘œ', () => {
            const click = { type: 'number', x: -10, y: 200 };
            runner.expect(validateAnnotationClick(click)).toBeFalse();
        });
        
        runner.test('ì–´ë…¸í…Œì´ì…˜ í´ë¦­ ê²€ì¦ - íƒ€ì… ëˆ„ë½', () => {
            const click = { x: 100, y: 200 };
            runner.expect(validateAnnotationClick(click)).toBeFalse();
        });
        
        runner.test('ìˆ«ì í¬ì§€ì…˜ ê³„ì‚° - medium í¬ê¸°', () => {
            const result = calculateNumberPosition(100, 200, 'medium');
            runner.expect(result).toEqual({ centerX: 100, centerY: 200, radius: 30 });
        });
        
        runner.test('ìˆ«ì í¬ì§€ì…˜ ê³„ì‚° - large í¬ê¸°', () => {
            const result = calculateNumberPosition(150, 250, 'large');
            runner.expect(result).toEqual({ centerX: 150, centerY: 250, radius: 40 });
        });
        
        runner.test('ìˆ«ì í¬ì§€ì…˜ ê³„ì‚° - ê¸°ë³¸ í¬ê¸°', () => {
            const result = calculateNumberPosition(50, 75, 'unknown');
            runner.expect(result).toEqual({ centerX: 50, centerY: 75, radius: 30 });
        });
        
        runner.test('ìƒ‰ìƒ ìœ íš¨ì„± ê²€ì‚¬ - ìœ íš¨í•œ hex', () => {
            runner.expect(isValidColor('#FF0000')).toBeTrue();
            runner.expect(isValidColor('#abc')).toBeTrue();
        });
        
        runner.test('ìƒ‰ìƒ ìœ íš¨ì„± ê²€ì‚¬ - ì˜ëª»ëœ hex', () => {
            runner.expect(isValidColor('#GG0000')).toBeFalse();
            runner.expect(isValidColor('#12')).toBeFalse();
        });
        
        runner.test('ìƒ‰ìƒ ìœ íš¨ì„± ê²€ì‚¬ - ìœ íš¨í•œ ìƒ‰ìƒëª…', () => {
            runner.expect(isValidColor('red')).toBeTrue();
            runner.expect(isValidColor('BLUE')).toBeTrue();
        });
        
        runner.test('ìƒ‰ìƒ ìœ íš¨ì„± ê²€ì‚¬ - ì˜ëª»ëœ ì…ë ¥', () => {
            runner.expect(isValidColor('')).toBeFalse();
            runner.expect(isValidColor(null)).toBeFalse();
            runner.expect(isValidColor('purple')).toBeFalse();
        });
        
        runner.test('ìë™ ë¦¬ì‚¬ì´ì¦ˆ - ì‘ì€ ì´ë¯¸ì§€ (ë³€ê²½ ì—†ìŒ)', () => {
            const result = calculateImageDimensions(800, 600, 'auto');
            runner.expect(result).toEqual({ width: 800, height: 600 });
        });
        
        runner.test('ì´ë¯¸ì§€ í¬ê¸° ê³„ì‚° - í­ì´ ë” í° ê²½ìš°', () => {
            const result = calculateImageDimensions(2800, 800, 'auto');
            runner.expect(result.width).toBe(1400);
            runner.expect(result.height).toBe(400);
        });
        
        function runAllTests() {
            const { passed, failed, results } = runner.run();
            
            const resultsDiv = document.getElementById('test-results');
            resultsDiv.innerHTML = '';
            
            results.forEach(({ name, status, error }) => {
                const div = document.createElement('div');
                div.className = `test-result ${status}`;
                div.innerHTML = `
                    <strong>${status === 'pass' ? 'âœ…' : 'âŒ'} ${name}</strong>
                    ${error ? `<br><small>Error: ${error}</small>` : ''}
                `;
                resultsDiv.appendChild(div);
            });
            
            const summary = document.createElement('div');
            summary.className = 'test-summary';
            summary.innerHTML = `
                <div>ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼: ${passed}ê°œ í†µê³¼, ${failed}ê°œ ì‹¤íŒ¨</div>
                <div>âš¡ ì‹¤í–‰ ì‹œê°„: ${Date.now() % 1000}ms (ì˜ˆì‹œ)</div>
            `;
            resultsDiv.appendChild(summary);
        }
    </script>
</body>
</html>