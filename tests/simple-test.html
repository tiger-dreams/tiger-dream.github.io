<!DOCTYPE html>
<html>
<head>
    <title>ê°„ë‹¨í•œ ìœ ë‹› í…ŒìŠ¤íŠ¸ ë°ëª¨</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-result { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .pass { background-color: #d4edda; color: #155724; }
        .fail { background-color: #f8d7da; color: #721c24; }
        .test-summary { margin-top: 20px; font-weight: bold; }
    </style>
</head>
<body>
    <h1>ğŸ§ª AnnotateShot ìœ ë‹› í…ŒìŠ¤íŠ¸ ë°ëª¨</h1>
    <p>ì´ê²ƒì´ ì‹¤ì œ ìœ ë‹› í…ŒìŠ¤íŠ¸ê°€ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€ ë³´ì—¬ì£¼ëŠ” ì˜ˆì‹œì…ë‹ˆë‹¤.</p>
    
    <button onclick="runAllTests()">í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
    
    <div id="test-results"></div>
    
    <script>
        // í…ŒìŠ¤íŠ¸í•  í•¨ìˆ˜ë“¤ (main.jsì—ì„œ ë¶„ë¦¬ëœ ìˆœìˆ˜ í•¨ìˆ˜ë“¤)
        function calculateImageDimensions(width, height, mode) {
            switch(mode) {
                case 'scale50':
                    return { width: Math.floor(width * 0.5), height: Math.floor(height * 0.5) };
                case 'scale30':
                    return { width: Math.floor(width * 0.3), height: Math.floor(height * 0.3) };
                case 'original':
                    return { width, height };
                default:
                    // Auto resize logic (simplified)
                    const maxWidth = 1400;
                    const maxHeight = 900;
                    if (width > maxWidth || height > maxHeight) {
                        const scale = Math.min(maxWidth / width, maxHeight / height);
                        return { 
                            width: Math.floor(width * scale), 
                            height: Math.floor(height * scale) 
                        };
                    }
                    return { width, height };
            }
        }
        
        function getColorFromSelector(colorValue) {
            const colorMap = {
                'red': '#FF0000',
                'blue': '#0000FF',
                'green': '#00FF00'
            };
            return colorMap[colorValue] || colorValue;
        }
        
        function translateText(key, lang = 'ko') {
            const translations = {
                ko: { save: 'ì €ì¥í•˜ê¸°', undo: 'ë’¤ë¡œê°€ê¸°', red: 'ë¹¨ê°„ìƒ‰' },
                en: { save: 'Save', undo: 'Undo', red: 'Red' }
            };
            return translations[lang]?.[key] || key;
        }

        // ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬
        class SimpleTestRunner {
            constructor() {
                this.tests = [];
                this.results = [];
            }
            
            test(name, testFunction) {
                this.tests.push({ name, testFunction });
            }
            
            expect(actual) {
                return {
                    toBe: (expected) => {
                        if (actual !== expected) {
                            throw new Error(`Expected ${expected}, but got ${actual}`);
                        }
                    },
                    toEqual: (expected) => {
                        if (JSON.stringify(actual) !== JSON.stringify(expected)) {
                            throw new Error(`Expected ${JSON.stringify(expected)}, but got ${JSON.stringify(actual)}`);
                        }
                    }
                };
            }
            
            run() {
                this.results = [];
                let passed = 0;
                let failed = 0;
                
                this.tests.forEach(({ name, testFunction }) => {
                    try {
                        testFunction();
                        this.results.push({ name, status: 'pass', error: null });
                        passed++;
                    } catch (error) {
                        this.results.push({ name, status: 'fail', error: error.message });
                        failed++;
                    }
                });
                
                return { passed, failed, results: this.results };
            }
        }
        
        // í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë“¤
        const runner = new SimpleTestRunner();
        
        runner.test('ì´ë¯¸ì§€ 50% ì¶•ì†Œ ê³„ì‚°', () => {
            const result = calculateImageDimensions(1000, 800, 'scale50');
            runner.expect(result).toEqual({ width: 500, height: 400 });
        });
        
        runner.test('ì´ë¯¸ì§€ 30% ì¶•ì†Œ ê³„ì‚°', () => {
            const result = calculateImageDimensions(1000, 800, 'scale30');
            runner.expect(result).toEqual({ width: 300, height: 240 });
        });
        
        runner.test('ì›ë³¸ í¬ê¸° ìœ ì§€', () => {
            const result = calculateImageDimensions(800, 600, 'original');
            runner.expect(result).toEqual({ width: 800, height: 600 });
        });
        
        runner.test('ìë™ ë¦¬ì‚¬ì´ì¦ˆ - í° ì´ë¯¸ì§€', () => {
            const result = calculateImageDimensions(2000, 1500, 'auto');
            // 1400x900 ë²”ìœ„ ë‚´ë¡œ ì¶•ì†Œë˜ì–´ì•¼ í•¨
            runner.expect(result.width <= 1400).toBe(true);
            runner.expect(result.height <= 900).toBe(true);
        });
        
        runner.test('ìƒ‰ìƒ ë³€í™˜ - red', () => {
            const result = getColorFromSelector('red');
            runner.expect(result).toBe('#FF0000');
        });
        
        runner.test('ë²ˆì—­ - í•œêµ­ì–´ ì €ì¥', () => {
            const result = translateText('save', 'ko');
            runner.expect(result).toBe('ì €ì¥í•˜ê¸°');
        });
        
        runner.test('ë²ˆì—­ - ì˜ì–´ ì €ì¥', () => {
            const result = translateText('save', 'en');
            runner.expect(result).toBe('Save');
        });
        
        function runAllTests() {
            const { passed, failed, results } = runner.run();
            
            const resultsDiv = document.getElementById('test-results');
            resultsDiv.innerHTML = '';
            
            results.forEach(({ name, status, error }) => {
                const div = document.createElement('div');
                div.className = `test-result ${status}`;
                div.innerHTML = `
                    <strong>${status === 'pass' ? 'âœ…' : 'âŒ'} ${name}</strong>
                    ${error ? `<br><small>Error: ${error}</small>` : ''}
                `;
                resultsDiv.appendChild(div);
            });
            
            const summary = document.createElement('div');
            summary.className = 'test-summary';
            summary.innerHTML = `
                <div>ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼: ${passed}ê°œ í†µê³¼, ${failed}ê°œ ì‹¤íŒ¨</div>
                <div>âš¡ ì‹¤í–‰ ì‹œê°„: ${Date.now() % 1000}ms (ì˜ˆì‹œ)</div>
            `;
            resultsDiv.appendChild(summary);
        }
    </script>
</body>
</html>