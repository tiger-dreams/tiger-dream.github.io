<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AnnotateShot: Effortless Screenshot Markup</title>
    <meta name="description" content="AnnotateShot - ìŠ¤í¬ë¦°ìƒ·ì— ì‰½ê²Œ ìˆ«ìì™€ ë„í˜•ì„ ì¶”ê°€í•˜ì„¸ìš”. ê°„í¸í•˜ê³  íš¨ê³¼ì ì¸ ì´ë¯¸ì§€ ì£¼ì„ ë„êµ¬.">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <!-- Early Extension Detection (ìµœìš°ì„  ì‹¤í–‰) -->
    <script>
        // Extension ìœ ì… ì¡°ê¸° ê°ì§€ ë° ì¦‰ì‹œ ë¡œë”© ë©”ì‹œì§€ í‘œì‹œ
        (function() {
            try {
                // URL íŒŒë¼ë¯¸í„°ë¡œ Extension ìœ ì… í™•ì¸
                const urlParams = new URLSearchParams(window.location.search);
                const isFromExtension = urlParams.get('source') === 'extension';
                
                const imageSource = localStorage.getItem('annotateshot_image_source');
                const capturedImage = localStorage.getItem('annotateshot_captured_image');
                
                // URL íŒŒë¼ë¯¸í„°ë¡œ Extension ìœ ì…ì´ë©´ ë¡œë”© ë©”ì‹œì§€ í‘œì‹œ (ì´ë¯¸ì§€ ë°ì´í„° ëŒ€ê¸° ì¤‘)
                if (isFromExtension) {
                    
                    // ì–¸ì–´ ê°ì§€
                    const isKorean = navigator.language && navigator.language.startsWith('ko');
                    const loadingText = isKorean ? 'ì´ë¯¸ì§€ ë¡œë”© ì¤‘...' : 'Loading image...';
                    const waitText = isKorean ? 'ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”' : 'Please wait';
                    
                    // ë¡œë”© ë©”ì‹œì§€ ì¦‰ì‹œ ìƒì„±
                    const loadingMessage = document.createElement('div');
                    loadingMessage.id = 'extension-loading-message';
                    loadingMessage.innerHTML = `
                        <div style="
                            position: fixed;
                            top: 50%;
                            left: 50%;
                            transform: translate(-50%, -50%);
                            background: rgba(0, 0, 0, 0.9);
                            color: white;
                            padding: 30px 40px;
                            border-radius: 12px;
                            z-index: 999999;
                            text-align: center;
                            font-family: 'Inter', system-ui, sans-serif;
                            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
                            backdrop-filter: blur(10px);
                        ">
                            <div style="
                                width: 40px;
                                height: 40px;
                                border: 3px solid #3b82f6;
                                border-top: 3px solid transparent;
                                border-radius: 50%;
                                animation: spin 1s linear infinite;
                                margin: 0 auto 20px;
                            "></div>
                            <div style="font-size: 18px; font-weight: 600; margin-bottom: 8px;">
                                ğŸ–¼ï¸ ${loadingText}
                            </div>
                            <div style="font-size: 14px; color: #94a3b8;">
                                ${waitText}
                            </div>
                        </div>
                        <style>
                            @keyframes spin {
                                0% { transform: rotate(0deg); }
                                100% { transform: rotate(360deg); }
                            }
                        </style>
                    `;
                    
                    // DOM ì¤€ë¹„ ì‹œ ì¦‰ì‹œ ì¶”ê°€
                    function addMessage() {
                        if (document.body) {
                            document.body.appendChild(loadingMessage);
                        } else if (document.documentElement) {
                            document.documentElement.appendChild(loadingMessage);
                        } else {
                            setTimeout(addMessage, 10);
                        }
                    }
                    addMessage();
                }
            } catch (error) {
                console.warn('âš ï¸ Extension ì¡°ê¸° ê°ì§€ ì‹¤íŒ¨:', error);
            }
        })();
    </script>
    
    <!-- Usage Monitoring -->
    <script src="usage-monitor.js"></script>
    
    <!-- Device Detection & Dynamic CSS Loading -->
    <script src="src/device-detector.js"></script>
    
    <!-- External CSS Files -->
    <link rel="stylesheet" href="src/styles/app.css">
    <link rel="stylesheet" href="src/styles/common.css" id="common-css">
    <link rel="stylesheet" href="src/styles/desktop.css" id="desktop-css">
    <link rel="stylesheet" href="src/styles/mobile.css" id="mobile-css" disabled>

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-4JDFWP6MTQ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-4JDFWP6MTQ');
    </script>
</head>
<body>
    <div class="app-container">
        <!-- Mobile Menu Button ì œê±°ë¨ -->

        <!-- Mobile Overlay -->
        <div class="mobile-overlay" id="mobileOverlay"></div>

        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <!-- Sidebar Header -->
            <div class="sidebar-header">
                <div class="logo-section">
                    <img src="extension/icon.png" alt="AnnotateShot Logo" class="logo-icon" style="width: 24px; height: 24px;">
                    <h1 class="logo-text">
                        <span class="desktop-text">AnnotateShot
                    </h1>
                </div>
            </div>

            <!-- Sidebar Content -->
            <div class="sidebar-content">
                <!-- File Operations -->
                <div class="tool-panel">
                    <div class="panel-title">
                        <span class="material-icons">folder_open</span>
                        <span data-lang-key="fileOperations">íŒŒì¼ ì‘ì—…</span>
                    </div>
                    <div class="btn-group">
                        <input type="file" id="imageLoader" accept="image/*" aria-label="Upload image file">
                        <div class="btn-row">
                            <button class="btn" id="clipboardButton" aria-label="Paste image from clipboard" title="Paste from Clipboard" style="height: 2.5rem;">
                                <span class="material-icons">content_paste</span>
                                <span data-lang-key="clipboard">í´ë¦½ë³´ë“œì—ì„œ ê°€ì ¸ì˜¤ê¸°</span>
                            </button>
                            <button class="btn btn-icon success" id="saveButton" aria-label="Save annotated image" title="Save Image">
                                <span class="material-icons">download</span>
                            </button>
                            <button class="btn btn-icon" id="copyToClipboardButton" aria-label="Copy to clipboard" title="Copy to Clipboard">
                                <span class="material-icons">content_copy</span>
                            </button>
                            <button class="btn btn-icon" id="undoButton" aria-label="Undo last action">
                                <span class="material-icons">undo</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Canvas Settings -->
                <div class="tool-panel">
                    <div class="panel-title">
                        <div class="panel-title-left">
                            <span class="material-icons">palette</span>
                            <span data-lang-key="canvasSettings">ìº”ë²„ìŠ¤ ì„¤ì •</span>
                        </div>
                    </div>
                    <div class="style-section">
                        <div class="style-subtitle" data-lang-key="canvasMode">ìº”ë²„ìŠ¤ ëª¨ë“œ</div>
                        <select id="canvasModeSelector" aria-label="Select canvas mode">
                            <option value="single" data-lang-key="singleImageMode">ì‹±ê¸€ ì´ë¯¸ì§€ í¸ì§‘</option>
                            <option value="multi" data-lang-key="multiImageMode">ë¹ˆ ìº”ë²„ìŠ¤ (ë©€í‹° ì´ë¯¸ì§€)</option>
                        </select>
                    </div>
                    <div class="style-section" id="backgroundColorSection" style="display: none;">
                        <div class="style-subtitle" data-lang-key="backgroundColor">ë°°ê²½ìƒ‰</div>
                        <select id="backgroundColorSelector" aria-label="Select background color">
                            <option value="" data-lang-key="pleaseSelect">ë°°ê²½ìƒ‰ì„ ì„ íƒí•´ì£¼ì„¸ìš”</option>
                            <option value="transparent" data-lang-key="transparent">íˆ¬ëª…</option>
                            <option value="white" data-lang-key="white">í°ìƒ‰</option>
                            <option value="light-gray" data-lang-key="lightGray">ì—°í•œ íšŒìƒ‰</option>
                            <option value="gray" data-lang-key="gray">íšŒìƒ‰</option>
                            <option value="dark-gray" data-lang-key="darkGray">ì§™ì€ íšŒìƒ‰</option>
                        </select>
                    </div>
                    <div class="style-section" id="canvasSizeSection" style="display: none;">
                        <div class="style-subtitle" data-lang-key="canvasSize">ìº”ë²„ìŠ¤ í¬ê¸°</div>
                        <select id="canvasSizeSelector" aria-label="Select canvas size">
                            <option value="" data-lang-key="pleaseSelectSize">ìº”ë²„ìŠ¤ í¬ê¸°ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</option>
                            <option value="1920x1080" data-lang-key="size1920x1080">Full HD (1920Ã—1080)</option>
                            <option value="1280x720" data-lang-key="size1280x720">HD (1280Ã—720)</option>
                            <option value="1200x800" data-lang-key="size1200x800">ì›¹ í‘œì¤€ (1200Ã—800)</option>
                            <option value="800x600" data-lang-key="size800x600">í´ë˜ì‹ (800Ã—600)</option>
                            <option value="a4-landscape" data-lang-key="sizeA4Landscape">A4 ê°€ë¡œ (297Ã—210mm)</option>
                            <option value="a4-portrait" data-lang-key="sizeA4Portrait">A4 ì„¸ë¡œ (210Ã—297mm)</option>
                            <option value="custom" data-lang-key="sizeCustom">ì‚¬ìš©ì ì •ì˜</option>
                        </select>
                        <div id="customSizeSection" style="display: none; margin-top: 10px;">
                            <div style="display: flex; gap: 5px; align-items: center;">
                                <input type="number" id="customWidth" placeholder="ê°€ë¡œ" min="100" max="2000" style="width: 70px; padding: 5px; border: 1px solid #ddd; border-radius: 3px;">
                                <span>Ã—</span>
                                <input type="number" id="customHeight" placeholder="ì„¸ë¡œ" min="100" max="2000" style="width: 70px; padding: 5px; border: 1px solid #ddd; border-radius: 3px;">
                                <button id="applyCustomSize" style="padding: 5px 10px; border: 1px solid #ddd; border-radius: 3px; background: #f5f5f5; cursor: pointer;" data-lang-key="apply">ì ìš©</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Drawing Mode -->
                <div class="tool-panel">
                    <div class="panel-title">
                        <div class="panel-title-left">
                            <span class="material-icons">brush</span>
                            <span data-lang-key="annotationMode">ì£¼ì„ ëª¨ë“œ</span>
                        </div>
                    </div>
                    <div class="style-section">
                        <select id="modeSelector" aria-label="Select annotation mode">
                            <option value="number" data-lang-key="numberMode">ìˆ«ì ì…ë ¥ ëª¨ë“œ</option>
                            <option value="shape" data-lang-key="shapeMode">ë„í˜• ëª¨ë“œ</option>
                            <option value="text" data-lang-key="textMode">í…ìŠ¤íŠ¸ ëª¨ë“œ</option>
                            <option value="emoji" data-lang-key="emojiMode">ì´ëª¨ì§€ ëª¨ë“œ</option>
                            <option value="crop" data-lang-key="cropMode">í¬ë¡­ ëª¨ë“œ</option>
                        </select>
                    </div>
                </div>

                <!-- Style Panel -->
                <div class="tool-panel">
                    <div class="panel-title">
                        <span class="material-icons">palette</span>
                        <span data-lang-key="style">ìŠ¤íƒ€ì¼</span>
                    </div>
                    
                    <!-- Color Section -->
                    <div class="style-section panel-title" id="colorSection">
                        <div class="panel-title-left">
                            <span data-lang-key="color">ìƒ‰ìƒ</span>
                        </div>
                        <div class="panel-inline-control">
                            <select id="colorSelector" aria-label="Select annotation color">
                                <option value="#FF0000" data-lang-key="red">ë¹¨ê°„ìƒ‰</option>
                                <option value="#FF8000" data-lang-key="orange">ì£¼í™©ìƒ‰</option>
                                <option value="#00FF00" data-lang-key="green">ë…¹ìƒ‰</option>
                                <option value="#0000FF" data-lang-key="blue">íŒŒë‘ìƒ‰</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Size Section -->
                    <div class="style-section panel-title" id="sizeSection">
                        <div class="panel-title-left">
                            <span data-lang-key="size">í¬ê¸°</span>
                        </div>
                        <div class="panel-inline-control">
                            <select id="sizeSelector" aria-label="Select annotation size">
                                <option value="10">10px</option>
                                <option value="15">15px</option>
                                <option value="20" selected>20px</option>
                                <option value="25">25px</option>
                                <option value="30">30px</option>
                                <option value="35">35px</option>
                                <option value="40">40px</option>
                                <option value="45">45px</option>
                                <option value="50">50px</option>
                                <option value="55">55px</option>
                                <option value="60">60px</option>
                                <option value="65">65px</option>
                                <option value="70">70px</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Line Width Section (Shape mode only) -->
                    <div class="style-section panel-title" id="lineWidthSection" style="display: none;">
                        <div class="panel-title-left">
                            <span data-lang-key="lineWidth">êµµê¸°</span>
                        </div>
                        <div class="panel-inline-control">
                            <select id="lineWidthSelector" aria-label="Select line width">
                                <option value="1" data-lang-key="thin">ì–‡ìŒ</option>
                                <option value="2" selected data-lang-key="normal">ë³´í†µ</option>
                                <option value="4" data-lang-key="thick">ë‘êº¼ì›€</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Shape Section (Shape mode only) -->
                    <div class="style-section panel-title" id="shapeSection" style="display: none;">
                        <div class="panel-title-left">
                            <span data-lang-key="shape">ëª¨ì–‘</span>
                        </div>
                        <div class="panel-inline-control">
                            <select id="shapeSelector" aria-label="Select shape type">
                                <option value="rectangle" data-lang-key="rectangle">ì‚¬ê°í˜•</option>
                                <option value="circle" data-lang-key="circle">ì›</option>
                                <option value="arrow" data-lang-key="arrow">í™”ì‚´í‘œ</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Fill Section (Shape mode only, not for arrows) -->
                    <div class="style-section panel-title" id="fillSection" style="display: none;">
                        <div class="panel-title-left">
                            <span data-lang-key="fill">ì±„ìš°ê¸°</span>
                        </div>
                        <div class="panel-inline-control">
                            <select id="fillSelector" aria-label="Select fill type">
                                <option value="none" data-lang-key="fillNone">í…Œë‘ë¦¬ë§Œ</option>
                                <option value="solid" data-lang-key="fillSolid">ë‹¨ìƒ‰ ì±„ìš°ê¸°</option>
                                <option value="blur" data-lang-key="fillBlur">íë¦¼ íš¨ê³¼</option>
                                <option value="mosaic" data-lang-key="fillMosaic">ëª¨ìì´í¬</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Emoji Section (Emoji mode only) -->
                    <div class="style-section panel-title" id="emojiSection" style="display: none;">
                        <div class="panel-title-left">
                            <span data-lang-key="emojiType">ì´ëª¨ì§€ ì¢…ë¥˜</span>
                        </div>
                        <div class="panel-inline-control">
                            <select id="emojiSelector" aria-label="Select emoji">
                                <option value="ğŸ˜€">ğŸ˜€</option>
                                <option value="ğŸ˜">ğŸ˜</option>
                                <option value="ğŸ¤”">ğŸ¤”</option>
                                <option value="ğŸ‘">ğŸ‘</option>
                                <option value="ğŸ‘">ğŸ‘</option>
                                <option value="â¤ï¸">â¤ï¸</option>
                                <option value="â­">â­</option>
                                <option value="ğŸ”¥">ğŸ”¥</option>
                                <option value="ğŸ’¯">ğŸ’¯</option>
                                <option value="âœ…">âœ…</option>
                                <option value="âŒ">âŒ</option>
                                <option value="âš ï¸">âš ï¸</option>
                            </select>
                        </div>
                    </div>

                    <!-- Crop Section (Crop mode only) -->
                    <div class="style-section panel-title" id="cropSection" style="display: none;">
                        <div class="panel-title-left">
                            <span data-lang-key="cropStyle">í¬ë¡­ ìŠ¤íƒ€ì¼</span>
                        </div>
                        <div class="panel-inline-control">
                            <select id="cropStyleSelector" aria-label="Select crop style">
                                <option value="basic" data-lang-key="cropBasic">ê¸°ë³¸ í¬ë¡­</option>
                                <option value="torn" data-lang-key="cropTorn">ì°¢ì–´ì§„ ì¢…ì´</option>
                            </select>
                        </div>
                    </div>

                    <!-- Crop Controls Section -->
                    <div class="style-section panel-title" id="cropControlsSection" style="display: none;">
                        <div class="panel-title-left">
                            <span data-lang-key="cropControls">í¬ë¡­ ì»¨íŠ¸ë¡¤</span>
                        </div>
                        <div class="panel-inline-control">
                            <button id="applyCropButton" class="btn btn-primary" data-lang-key="applyCrop" disabled>í¬ë¡­ ì ìš©</button>
                        </div>
                        <div class="crop-info" id="cropInfo" style="display: none; margin-top: 8px; font-size: 12px; color: #666; grid-column: 1 / -1;">
                            <span data-lang-key="cropInstruction">ë“œë˜ê·¸í•˜ì—¬ í¬ë¡­ ì˜ì—­ì„ ì„ íƒí•˜ì„¸ìš”</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sidebar Footer -->
            <div class="sidebar-footer" style="padding: 1rem;">
                <div class="btn-group">
                    <!-- Footer Links -->
                    <div class="footer-links">
                        <a href="changelog.html" target="_blank" class="btn footer-link">
                            <span class="material-icons">description</span>
                            <span data-lang-key="releaseNotes">Release Notes</span>
                        </a>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Top Bar -->
            <header class="top-bar">
                <h2 data-lang-key="editImage">ì´ë¯¸ì§€ í¸ì§‘</h2>
                <div class="top-bar-actions">
                    <!-- Chrome Extension Link -->
                    <a href="https://chromewebstore.google.com/detail/annotateshot-capture/edngphlkihgcpcolnjadgopgkpfhdcce" target="_blank" class="chrome-extension-link" title="Chrome Extensionìœ¼ë¡œ ì›¹í˜ì´ì§€ ìº¡ì²˜í•˜ê¸°" style="display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem 1.25rem; background: linear-gradient(135deg, #4285f4, #34a853); color: white; text-decoration: none; border-radius: 6px; font-size: 0.875rem; margin-right: 1rem; transition: all 0.2s ease; white-space: nowrap;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2c5.52 0 10 4.48 10 10s-4.48 10-10 10S2 17.52 2 12 6.48 2 12 2zm3.5 6L12 10.5 8.5 8 6 12l2.5 4 3.5-2.5L15.5 16l2.5-4-2.5-4z"/>
                        </svg>
                        <span data-lang-key="chromeExtension" class="chrome-extension-text">Chrome Extension</span>
                    </a>
                    <label for="resizeSelector" style="font-size: 0.875rem; color: var(--muted-foreground); margin-right: 0.5rem; pointer-events: none; white-space: nowrap;" data-lang-key="imageSize">ì´ë¯¸ì§€ í¬ê¸°:</label>
                    <select id="resizeSelector" aria-label="Select image resize option" class="top-resize-selector" onclick="event.stopPropagation();">
                        <option value="default" selected data-lang-key="autoResize">ìë™ ë¦¬ì‚¬ì´ì¦ˆ (ê¸°ë³¸)</option>
                        <option value="original" data-lang-key="originalSize">ì›ë³¸</option>
                        <option value="300" data-lang-key="width300">ë„ˆë¹„ 300</option>
                        <option value="600" data-lang-key="width600">ë„ˆë¹„ 600</option>
                        <option value="900" data-lang-key="width900">ë„ˆë¹„ 900</option>
                        <option value="scale30" data-lang-key="scale30">ì›ë³¸ ëŒ€ë¹„ 30% ì¶•ì†Œ</option>
                        <option value="scale50" data-lang-key="scale50">ì›ë³¸ ëŒ€ë¹„ 50% ì¶•ì†Œ</option>
                        <option value="scale70" data-lang-key="scale70">ì›ë³¸ ëŒ€ë¹„ 70% ì¶•ì†Œ</option>
                    </select>
                    <button class="btn btn-icon" id="themeToggle" aria-label="Toggle theme">
                        <span class="material-icons">dark_mode</span>
                    </button>
                </div>
            </header>

            <!-- Canvas Area -->
            <div class="canvas-area">
                <!-- PC ì „ìš© ìº”ë²„ìŠ¤ -->
                <div class="canvas-container empty desktop-canvas" id="canvasContainer">
                    <div class="empty-state" id="emptyState">
                        <div class="material-icons">image</div>
                        <div id="uploadPromptText" data-lang-key="uploadImagePrompt">ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ê±°ë‚˜ í´ë¦½ë³´ë“œì—ì„œ ë¶™ì—¬ë„£ê¸°í•˜ì„¸ìš”</div>
                    </div>
                    <canvas id="imageCanvas" style="display: none;"></canvas>
                </div>
                
                <!-- ëª¨ë°”ì¼ ì „ìš© ìº”ë²„ìŠ¤ -->
                <div class="canvas-container empty mobile-canvas" id="mobileCanvasContainer">
                    <div class="empty-state mobile-empty-state" id="mobileEmptyState">
                        <div class="material-icons">image</div>
                        <div id="mobileUploadPromptText" class="mobile-prompt-text">
                            AnnotateShot ëª¨ë°”ì¼ ì‚¬ìš©ë²•<br>
                            1. í•˜ë‹¨ ğŸ“· ë²„íŠ¼ìœ¼ë¡œ ê°¤ëŸ¬ë¦¬ì—ì„œ ì´ë¯¸ì§€ë¥¼ ë¶ˆëŸ¬ì˜¤ì„¸ìš”<br>
                            2. ìˆ«ì ëª¨ë“œ: í™”ë©´ì„ í„°ì¹˜í•˜ì—¬ ìˆœì°¨ ë²ˆí˜¸ ì¶”ê°€<br>
                            3. ì´ëª¨ì§€ ëª¨ë“œ: í•˜ë‹¨ ğŸ˜€ ë²„íŠ¼ìœ¼ë¡œ ì„ íƒ í›„ í„°ì¹˜í•˜ì—¬ ì¶”ê°€<br>
                            4. í…ìŠ¤íŠ¸ ëª¨ë“œ: í™”ë©´ì„ í„°ì¹˜í•˜ë©´ í…ìŠ¤íŠ¸ ì…ë ¥ì°½ì´ ë‚˜íƒ€ë‚¨<br>
                            5. ëŒì–´ì„œ ì´ë™: ëª¨ë“  ì£¼ì„ì„ ë“œë˜ê·¸í•˜ì—¬ ìœ„ì¹˜ ì´ë™ ê°€ëŠ¥<br>
                            6. ìš°ì¸¡ ìƒë‹¨ ğŸ’¾ ë²„íŠ¼ìœ¼ë¡œ ì™„ì„±ëœ ì´ë¯¸ì§€ë¥¼ ì €ì¥í•˜ì„¸ìš”
                        </div>
                    </div>
                    <canvas id="mobileImageCanvas" style="display: none;"></canvas>
                </div>
            </div>

            <!-- Status Bar -->
            <footer class="status-bar">
                <div class="status-info" id="statusInfo">
                    <span id="statusText" data-lang-key="mouseMovePrompt">ë§ˆìš°ìŠ¤ë¥¼ ì›€ì§ì—¬ë³´ì„¸ìš”</span>
                </div>
            </footer>
        </main>

        <!-- Right Layer Sidebar -->
        <aside class="layer-sidebar" id="layerSidebar">
            <div class="layer-sidebar-header">
                <div class="layer-sidebar-header-content">
                    <span class="material-icons">layers</span>
                    <h3 data-lang-key="layers">ë ˆì´ì–´</h3>
                </div>
            </div>
            
            <div class="layer-sidebar-content">
                <div class="layer-list" id="layerList">
                    <div class="layer-item background-layer">
                        <div class="layer-info">
                            <span class="material-icons layer-icon">image</span>
                            <span class="layer-name" data-lang-key="backgroundLayer">ë°°ê²½ ì´ë¯¸ì§€</span>
                        </div>
                        <div class="layer-controls">
                            <button class="layer-visibility-toggle" aria-label="Toggle visibility">
                                <span class="material-icons">visibility</span>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="layer-actions">
                    <button class="btn btn-sm" id="clearAllLayers" data-lang-key="clearAllLayers">
                        <span class="material-icons">clear_all</span>
                        ëª¨ë“  ë ˆì´ì–´ ì§€ìš°ê¸°
                    </button>
                </div>

                <!-- Language Selector in Layer Sidebar -->
                <div class="layer-language" style="border-top: 1px solid var(--border); margin-top: 0.75rem; padding: 16px;">
                    <label for="languageSelector" style="display:block; font-size: 0.8rem; color: var(--muted-foreground); margin-bottom: 0.5rem;" data-lang-key="language">ì–¸ì–´</label>
                    <select id="languageSelector" aria-label="Select language" style="width: 100%; padding: 0.5rem 0.75rem; background: var(--muted); color: var(--foreground); border: 1px solid var(--border); border-radius: var(--radius);">
                        <option value="en">English</option>
                        <option value="ko">í•œêµ­ì–´</option>
                        <option value="ja">æ—¥æœ¬èª</option>
                    </select>
                    
                    <!-- Divider -->
                    <div style="border-top: 1px solid var(--border); margin: 1rem 0;"></div>
                    
                    <!-- Sub Services Selector -->
                    <div class="panel-title" style="margin-bottom: 0;">
                        <div class="panel-title-left">
                            <span class="material-icons">apps</span>
                            <span data-lang-key="subServices">ë‹¤ë¥¸ <br>ì„œë¹„ìŠ¤</span>
                        </div>
                        <div class="panel-inline-control">
                            <select id="subServiceSelector" aria-label="Select sub service">
                                <option value="" data-lang-key="selectService">ì„œë¹„ìŠ¤ ì„ íƒ</option>
                                <option value="delcodelinenum.html" data-lang-key="codeLineRemover">Code Line Remover</option>
                                <option value="pdfcompress.html" data-lang-key="pdfCompress">PDF Compress</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </aside>
    </div>

    <!-- Message -->
    <div id="message"></div>

    <!-- Utilities -->
    <script src="./src/utils/scroll-utils.js"></script>
    <script src="./src/utils/canvas-utils.js"></script>
    <script src="./src/utils/storage.js"></script>

    <!-- Translation Service -->
    <script src="./src/i18n/translation-service.js"></script>

    <!-- Extension Bridge -->
    <script src="./src/integration/extension-bridge.js"></script>

    <!-- UI Controller -->
    <script src="./src/ui/ui-controller.js"></script>

    <script src="./src/main.js"></script>

    <!-- ëª¨ë°”ì¼ ì „ìš© UI ì»´í¬ë„ŒíŠ¸ë“¤ -->
    <div class="mobile-only" style="display: none;">
        <!-- í”Œë¡œíŒ… ì•¡ì…˜ ë²„íŠ¼ë“¤ -->
        <div class="floating-action-buttons">
            <button class="fab" id="fabImage" title="ì´ë¯¸ì§€ ì—…ë¡œë“œ">
                <span class="material-icons">add_photo_alternate</span>
            </button>
            <button class="fab save" id="fabSave" title="ì €ì¥">
                <span class="material-icons">save</span>
            </button>
            <button class="fab undo" id="fabUndo" title="ë˜ëŒë¦¬ê¸°">
                <span class="material-icons">undo</span>
            </button>
            <button class="fab" id="fabSettings" title="ìŠ¤íƒ€ì¼ ì„¤ì •">
                <span class="material-icons">palette</span>
            </button>
        </div>
        
        <!-- ëª¨ë°”ì¼ ì „ìš© ìˆ¨ê²¨ì§„ íŒŒì¼ ì…ë ¥ -->
        <input type="file" id="mobileImageInput" accept="image/*" capture="environment" style="display: none;">
    </div>

        <!-- ì´ëª¨ì§€ ì„ íƒ ë ˆì´ì–´ (íŒì—…) -->
        <div class="emoji-layer" id="emojiLayer" style="display: none;">
            <div class="emoji-layer-header">
                <h3>ì´ëª¨ì§€ ì„ íƒ</h3>
                <button class="emoji-close-btn" id="emojiCloseBtn">
                    <span class="material-icons">close</span>
                </button>
            </div>
            <div class="emoji-layer-grid">
                <button class="emoji-layer-btn" data-emoji="ğŸ˜€">ğŸ˜€</button>
                <button class="emoji-layer-btn" data-emoji="ğŸ˜">ğŸ˜</button>
                <button class="emoji-layer-btn" data-emoji="ğŸ¤”">ğŸ¤”</button>
                <button class="emoji-layer-btn" data-emoji="ğŸ‘">ğŸ‘</button>
                <button class="emoji-layer-btn" data-emoji="ğŸ‘">ğŸ‘</button>
                <button class="emoji-layer-btn" data-emoji="â¤ï¸">â¤ï¸</button>
                <button class="emoji-layer-btn" data-emoji="â­">â­</button>
                <button class="emoji-layer-btn" data-emoji="ğŸ”¥">ğŸ”¥</button>
                <button class="emoji-layer-btn" data-emoji="ğŸ’¯">ğŸ’¯</button>
                <button class="emoji-layer-btn" data-emoji="âœ…">âœ…</button>
                <button class="emoji-layer-btn" data-emoji="âŒ">âŒ</button>
                <button class="emoji-layer-btn" data-emoji="âš ï¸">âš ï¸</button>
            </div>
        </div>

        <!-- ëª¨ë°”ì¼ í•˜ë‹¨ íˆ´ë°” -->
        <div class="mobile-toolbar">
            <button class="toolbar-button" data-mode="number">
                <span class="material-icons">format_list_numbered</span>
                <span>ìˆ«ì</span>
            </button>
            <button class="toolbar-button" data-mode="text">
                <span class="material-icons">text_fields</span>
                <span>í…ìŠ¤íŠ¸</span>
            </button>
            <button class="toolbar-button" data-mode="emoji">
                <span class="material-icons">sentiment_satisfied</span>
                <span>ì´ëª¨ì§€</span>
            </button>
        </div>

        <!-- ëª¨ë°”ì¼ ëª¨ë“œ ì„ íƒ íŒ¨ë„ -->
        <div class="mobile-mode-panel" id="mobileModePanel">
            <h3 style="margin-top: 0; text-align: center;">í¸ì§‘ ëª¨ë“œ ì„ íƒ</h3>
            <div class="mode-grid">
                <div class="mode-card" onclick="selectMobileMode('number')">
                    <span class="material-icons">format_list_numbered</span>
                    <div class="mode-name">ìˆ«ì ëª¨ë“œ</div>
                </div>
                <div class="mode-card" onclick="selectMobileMode('shape')">
                    <span class="material-icons">crop_square</span>
                    <div class="mode-name">ë„í˜• ëª¨ë“œ</div>
                </div>
                <div class="mode-card" onclick="selectMobileMode('text')">
                    <span class="material-icons">text_fields</span>
                    <div class="mode-name">í…ìŠ¤íŠ¸ ëª¨ë“œ</div>
                </div>
                <div class="mode-card" onclick="selectMobileMode('emoji')">
                    <span class="material-icons">sentiment_satisfied</span>
                    <div class="mode-name">ì´ëª¨ì§€ ëª¨ë“œ</div>
                </div>
            </div>
            <button onclick="hideMobileModePanel()" style="margin-top: 1.5rem; width: 100%; padding: 1rem; background-color: var(--muted); border: none; border-radius: 8px; color: var(--foreground); font-size: 1rem;">ë‹«ê¸°</button>
        </div>
        
        <!-- ëª¨ë°”ì¼ ì„¤ì • íŒ¨ë„ -->
        <div class="mobile-settings-panel" id="mobileSettingsPanel">
            <h3 style="margin-top: 0; text-align: center; color: var(--foreground);">ìŠ¤íƒ€ì¼ ì„¤ì •</h3>
            
            <!-- ìƒ‰ìƒ ì„ íƒ -->
            <div class="setting-section">
                <h4 style="margin: 0 0 1rem 0; color: var(--foreground); font-size: 1rem;">ìƒ‰ìƒ</h4>
                <div class="mobile-color-grid">
                    <button class="mobile-color-btn" data-color="#FF0000" style="background: #FF0000;" title="ë¹¨ê°„ìƒ‰"></button>
                    <button class="mobile-color-btn" data-color="#FF8000" style="background: #FF8000;" title="ì£¼í™©ìƒ‰"></button>
                    <button class="mobile-color-btn" data-color="#00FF00" style="background: #00FF00;" title="ë…¹ìƒ‰"></button>
                    <button class="mobile-color-btn" data-color="#0000FF" style="background: #0000FF;" title="íŒŒë€ìƒ‰"></button>
                    <button class="mobile-color-btn" data-color="#FF00FF" style="background: #FF00FF;" title="ìì£¼ìƒ‰"></button>
                    <button class="mobile-color-btn" data-color="#00FFFF" style="background: #00FFFF;" title="ì²­ë¡ìƒ‰"></button>
                    <button class="mobile-color-btn" data-color="#FFFF00" style="background: #FFFF00;" title="ë…¸ë€ìƒ‰"></button>
                    <button class="mobile-color-btn" data-color="#000000" style="background: #000000;" title="ê²€ì€ìƒ‰"></button>
                </div>
            </div>
            
            <!-- í¬ê¸° ì¡°ì • -->
            <div class="setting-section">
                <h4 style="margin: 0 0 1rem 0; color: var(--foreground); font-size: 1rem;">í¬ê¸°</h4>
                <div class="mobile-size-slider">
                    <input type="range" id="mobileSizeSlider" min="10" max="70" step="5" value="20" style="width: 100%;">
                    <div style="display: flex; justify-content: space-between; font-size: 0.8rem; color: var(--muted-foreground); margin-top: 0.5rem;">
                        <span>10px</span>
                        <span id="mobileSizeValue">20px</span>
                        <span>70px</span>
                    </div>
                </div>
            </div>
            
            <!-- ì´ëª¨ì§€ ì„ íƒ (ì´ëª¨ì§€ ëª¨ë“œì¼ ë•Œë§Œ í‘œì‹œ) -->
            <div class="setting-section" id="emojiSection" style="display: none;">
                <h4 style="margin: 0 0 1rem 0; color: var(--foreground); font-size: 1rem;">ì´ëª¨ì§€ ì„ íƒ</h4>
                <div class="mobile-emoji-grid">
                    <button class="mobile-emoji-btn" data-emoji="ğŸ˜€">ğŸ˜€</button>
                    <button class="mobile-emoji-btn" data-emoji="ğŸ˜">ğŸ˜</button>
                    <button class="mobile-emoji-btn" data-emoji="ğŸ¤”">ğŸ¤”</button>
                    <button class="mobile-emoji-btn" data-emoji="ğŸ‘">ğŸ‘</button>
                    <button class="mobile-emoji-btn" data-emoji="ğŸ‘">ğŸ‘</button>
                    <button class="mobile-emoji-btn" data-emoji="â¤ï¸">â¤ï¸</button>
                    <button class="mobile-emoji-btn" data-emoji="â­">â­</button>
                    <button class="mobile-emoji-btn" data-emoji="ğŸ”¥">ğŸ”¥</button>
                    <button class="mobile-emoji-btn" data-emoji="ğŸ’¯">ğŸ’¯</button>
                    <button class="mobile-emoji-btn" data-emoji="âœ…">âœ…</button>
                    <button class="mobile-emoji-btn" data-emoji="âŒ">âŒ</button>
                    <button class="mobile-emoji-btn" data-emoji="âš ï¸">âš ï¸</button>
                </div>
            </div>
            
            <!-- ë„í˜• ì±„ìš°ê¸° ì˜µì…˜ (ë„í˜• ëª¨ë“œì¼ ë•Œë§Œ í‘œì‹œ) -->
            <div class="setting-section" id="shapeSection" style="display: none;">
                <h4 style="margin: 0 0 1rem 0; color: var(--foreground); font-size: 1rem;">ì±„ìš°ê¸° ì˜µì…˜</h4>
                <div class="mobile-fill-options">
                    <button class="mobile-fill-btn active" data-fill="none">í…Œë‘ë¦¬ë§Œ</button>
                    <button class="mobile-fill-btn" data-fill="solid">ì±„ìš°ê¸°</button>
                    <button class="mobile-fill-btn" data-fill="blur">íë¦¼</button>
                    <button class="mobile-fill-btn" data-fill="mosaic">ëª¨ìì´í¬</button>
                </div>
            </div>
            
            <button onclick="hideMobileSettingsPanel()" style="margin-top: 1.5rem; width: 100%; padding: 1rem; background-color: var(--muted); border: none; border-radius: 8px; color: var(--foreground); font-size: 1rem;">ë‹«ê¸°</button>
        </div>
        
        <!-- ëª¨ë°”ì¼ ë””ë²„ê·¸ ë¡œê·¸ íŒ¨ë„ -->
        <div class="mobile-debug-panel" id="mobileDebugPanel" style="display: none;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                <h3 style="margin: 0; color: #00FF00; font-size: 1rem;">ğŸ› Debug Log</h3>
                <div>
                    <button onclick="copyMobileDebugLog()" style="padding: 0.5rem; background: #00AA00; color: white; border: none; border-radius: 4px; margin-right: 0.5rem; font-size: 0.8rem;">Copy</button>
                    <button onclick="clearMobileDebugLog()" style="padding: 0.5rem; background: #FF4444; color: white; border: none; border-radius: 4px; margin-right: 0.5rem; font-size: 0.8rem;">Clear</button>
                    <button onclick="hideMobileDebugPanel()" style="padding: 0.5rem; background: #666; color: white; border: none; border-radius: 4px; font-size: 0.8rem;">Hide</button>
                </div>
            </div>
            <div id="mobileDebugLog" style="font-family: monospace; font-size: 0.8rem; color: #00FF00; background: #000; padding: 1rem; border-radius: 8px; max-height: 300px; overflow-y: auto; white-space: pre-wrap; word-break: break-all;"></div>
        </div>
    </div>

    <!-- Mobile UI Module - ëª¨ë“  DOMì´ ë¡œë“œëœ í›„ ì‹¤í–‰ -->
    <script src="src/mobile.js"></script>
    
    <!-- ëª¨ë°”ì¼ ë””ë²„ê·¸ ìŠ¤í¬ë¦½íŠ¸ -->
    <script>
        function copyMobileDebugLog() {
            const logDiv = document.getElementById('mobileDebugLog');
            if (logDiv && logDiv.textContent) {
                try {
                    // ëª¨ë°”ì¼ì—ì„œ ì•ˆì „í•œ ë³µì‚¬ ë°©ë²•
                    const textArea = document.createElement('textarea');
                    textArea.value = logDiv.textContent;
                    textArea.style.position = 'fixed';
                    textArea.style.left = '-9999px';
                    textArea.style.top = '-9999px';
                    document.body.appendChild(textArea);
                    textArea.focus();
                    textArea.select();
                    
                    const successful = document.execCommand('copy');
                    document.body.removeChild(textArea);
                    
                    if (successful) {
                        alert('ë””ë²„ê·¸ ë¡œê·¸ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
                    } else {
                        alert('ë³µì‚¬ ì‹¤íŒ¨ - ìˆ˜ë™ìœ¼ë¡œ ì„ íƒí•´ì„œ ë³µì‚¬í•˜ì„¸ìš”');
                    }
                } catch (err) {
                    alert('ë³µì‚¬ ê¸°ëŠ¥ ì‚¬ìš© ë¶ˆê°€ - ë¡œê·¸ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ë³µì‚¬í•˜ì„¸ìš”');
                }
            }
        }
        
        function clearMobileDebugLog() {
            const logDiv = document.getElementById('mobileDebugLog');
            if (logDiv) {
                logDiv.textContent = '';
            }
        }
        
        function hideMobileDebugPanel() {
            const panel = document.getElementById('mobileDebugPanel');
            if (panel) {
                panel.style.display = 'none';
            }
        }
    </script>
    
    <!-- ë””ë²„ê·¸ ìŠ¤í¬ë¦½íŠ¸ -->
    <script>
        // iPhone Safari ë””ë²„ê·¸ ì •ë³´ ì¶œë ¥
        setTimeout(() => {
        }, 2000);
    </script>

</body>
</html>