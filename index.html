<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-adsense-account" content="ca-pub-3945001668113003">
    <title>AnnotateShot: Effortless Screenshot Markup</title>
    <meta name="description" content="AnnotateShot - ìŠ¤í¬ë¦°ìƒ·ì— ì‰½ê²Œ ìˆ«ìì™€ ë„í˜•ì„ ì¶”ê°€í•˜ì„¸ìš”. ê°„í¸í•˜ê³  íš¨ê³¼ì ì¸ ì´ë¯¸ì§€ ì£¼ì„ ë„êµ¬.">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <!-- Usage Monitoring -->
    <script src="usage-monitor.js"></script>
    
    <style>
        :root {
            /* Light theme colors */
            --background: #ffffff;
            --foreground: #0f172a;
            --card: #ffffff;
            --card-foreground: #0f172a;
            --primary: #3b82f6;
            --primary-foreground: #ffffff;
            --secondary: #f1f5f9;
            --secondary-foreground: #0f172a;
            --muted: #f1f5f9;
            --muted-foreground: #64748b;
            --accent: #f1f5f9;
            --accent-foreground: #0f172a;
            --border: #e2e8f0;
            --input: #e2e8f0;
            --ring: #3b82f6;
            --radius: 0.5rem;
            --success-color: #22c55e;
            --destructive: #ef4444;
            --destructive-foreground: #ffffff;
            
            /* Sidebar specific */
            --sidebar-background: var(--card);
            --sidebar-foreground: var(--card-foreground);
            --sidebar-border: var(--border);
        }

        .dark {
            /* Dark theme colors */
            --background: #0f172a;
            --foreground: #f8fafc;
            --card: #1e293b;
            --card-foreground: #f8fafc;
            --primary: #3b82f6;
            --primary-foreground: #ffffff;
            --secondary: #334155;
            --secondary-foreground: #f8fafc;
            --muted: #334155;
            --muted-foreground: #94a3b8;
            --accent: #334155;
            --accent-foreground: #f8fafc;
            --border: #334155;
            --input: #334155;
            --ring: #3b82f6;
            --success-color: #22c55e;
            --destructive: #ef4444;
            --destructive-foreground: #ffffff;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', system-ui, sans-serif;
            background-color: var(--background);
            color: var(--foreground);
            margin: 0;
            padding: 0;
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
        }

        .app-container {
            display: flex;
            height: 100vh;
            background-color: var(--background);
        }

        /* Sidebar Styles */
        .sidebar {
            background-color: var(--card);
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            z-index: 20;
            width: 280px;
        }

        .sidebar-header {
            padding: 1rem;
            border-bottom: 1px solid var(--border);
            height: 74px;
            display: flex;
            align-items: center;
        }

        .sidebar-header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .logo-icon {
            color: var(--primary);
            font-size: 1.5rem;
        }

        .logo-text {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--foreground);
        }

        .sidebar-content {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
        }

        .tool-panel {
            margin-bottom: 1.5rem;
        }

        .panel-title {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--foreground);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }


        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.5rem 1rem;
            border-radius: var(--radius);
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s;
            cursor: pointer;
            border: 1px solid var(--border);
            background-color: var(--background);
            color: var(--foreground);
            text-decoration: none;
            min-height: 2.5rem;
        }

        .btn:hover {
            background-color: var(--muted);
        }

        .btn.primary {
            background-color: var(--primary);
            color: var(--primary-foreground);
            border-color: var(--primary);
        }

        .btn.primary:hover {
            background-color: var(--primary);
            opacity: 0.9;
        }

        .btn.btn-icon {
            padding: 0.5rem;
            width: 2.5rem;
            height: 2.5rem;
            justify-content: center;
        }

        .btn.btn-icon .material-icons {
            margin: 0;
        }

        .btn.success {
            background-color: var(--success-color);
            color: white;
            border-color: var(--success-color);
        }

        .btn.success:hover {
            background-color: var(--success-color);
            opacity: 0.9;
        }

        .btn-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .btn-row {
            display: flex;
            gap: 0.5rem;
        }


        select {
            width: 100%;
            padding: 0.5rem;
            border-radius: var(--radius);
            border: 1px solid var(--border);
            background-color: var(--background);
            color: var(--foreground);
            font-size: 0.875rem;
            min-height: 2.5rem;
        }

        select:focus {
            outline: none;
            border-color: var(--ring);
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);
        }

        input[type="file"] {
            width: 100%;
            padding: 0.5rem;
            border-radius: var(--radius);
            border: 1px solid var(--border);
            background-color: var(--background);
            color: var(--foreground);
            font-size: 0.875rem;
            cursor: pointer;
        }


        .style-section {
            margin-bottom: 1rem;
        }

        .style-subtitle {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--muted-foreground);
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.025em;
        }

        .footer-links {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .footer-link {
            justify-content: flex-start;
            gap: 0.75rem;
            font-size: 0.825rem;
            color: var(--muted-foreground);
            text-decoration: none;
            background-color: transparent;
            border: none;
            padding: 0.75rem;
        }

        .footer-link:hover {
            background-color: var(--muted);
            color: var(--foreground);
        }

        .footer-link .material-icons {
            font-size: 1rem;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            background-color: var(--background);
        }

        .top-bar {
            background-color: var(--card);
            border-bottom: 1px solid var(--border);
            padding: 1rem;
            height: 74px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
            pointer-events: auto;
        }

        .top-bar h2 {
            font-size: 1.125rem;
            font-weight: 500;
            color: var(--foreground);
            margin: 0;
            flex: 1;
        }

        .top-bar-actions {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            position: relative;
            z-index: 110;
            pointer-events: auto;
        }

        .chrome-extension-link:hover {
            background: linear-gradient(135deg, #3367d6, #2d8659) !important;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        .chrome-extension-link:active {
            transform: translateY(0);
        }

        /* ëª¨ë°”ì¼ ì „ìš© UI - User Agent ê¸°ë°˜ */
        .mobile-device .chrome-extension-link {
            display: none !important; /* ëª¨ë°”ì¼ì—ì„œ ì™„ì „íˆ ìˆ¨ê¹€ */
        }
        
        .mobile-device .top-bar-actions {
            gap: 0.25rem;
        }
        
        .mobile-device .top-bar-actions label {
            font-size: 0.75rem !important;
        }
        
        /* ëª¨ë°”ì¼ì—ì„œ ë¦¬ì‚¬ì´ì¦ˆ ì˜µì…˜ ìˆ¨ê¸°ê¸° */
        .mobile-device .top-resize-selector option:not([value=""]):not([value="auto"]) {
            display: none;
        }
        
        /* ëª¨ë°”ì¼ì—ì„œ ë¶ˆí•„ìš”í•œ ì»¨íŠ¸ë¡¤ë“¤ ìˆ¨ê¸°ê¸° */
        .mobile-device .sidebar .control-group:has(.top-resize-selector) label {
            display: none;
        }
        
        /* ëª¨ë°”ì¼ ìƒë‹¨ë°” ê°œì„  */
        .mobile-device .top-bar {
            justify-content: center;
            padding: 1rem 3rem;
        }
        
        .mobile-device .top-bar::before {
            content: "AnnotateShot";
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--foreground);
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .mobile-device .top-bar-actions {
            opacity: 0.7;
            transform: scale(0.9);
        }
        
        /* ëª¨ë°”ì¼ì—ì„œ ì‚¬ì´ë“œë°” í—¤ë” í…ìŠ¤íŠ¸ ìˆ¨ê¸°ê¸° */
        .mobile-device .sidebar-header .logo-text {
            display: none;
        }
        
        .mobile-device .sidebar-header {
            padding: 1rem;
            text-align: center;
        }

        .top-resize-selector {
            min-width: 180px;
            padding: 0.5rem;
            border-radius: var(--radius);
            border: 1px solid var(--border);
            background-color: var(--background);
            color: var(--foreground);
            font-size: 0.875rem;
            min-height: 2.5rem;
            cursor: pointer;
            position: relative;
            z-index: 120;
            pointer-events: auto;
        }

        .top-resize-selector:focus {
            outline: none;
            border-color: var(--ring);
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);
            z-index: 121;
        }

        .top-resize-selector:hover {
            background-color: var(--muted);
        }


        .canvas-area {
            flex: 1;
            padding: 1.5rem;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: var(--muted);
            background-image: 
                radial-gradient(circle, var(--border) 1px, transparent 1px);
            background-size: 20px 20px;
        }

        .canvas-container {
            position: relative;
            background: var(--card);
            border-radius: calc(var(--radius) * 2);
            padding: 1rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            max-width: 100%;
            max-height: 100%;
            overflow: auto;
        }

        #imageCanvas {
            border-radius: var(--radius);
            display: block;
        }
        
        #imageCanvas.default-canvas {
            max-width: 100%;
            max-height: 100%;
        }

        #imageCanvas.transparent-background {
            background-image: 
                linear-gradient(45deg, #e0e0e0 25%, transparent 25%), 
                linear-gradient(-45deg, #e0e0e0 25%, transparent 25%), 
                linear-gradient(45deg, transparent 75%, #e0e0e0 75%), 
                linear-gradient(-45deg, transparent 75%, #e0e0e0 75%);
            background-size: 60px 60px;
            background-position: 0 0, 0 30px, 30px -30px, -30px 0px;
            background-color: #ffffff;
        }

        .status-bar {
            background-color: var(--card);
            border-top: 1px solid var(--border);
            padding: 0.5rem 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
            color: var(--muted-foreground);
            font-family: 'Courier New', monospace;
        }

        .status-info {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        #statusText {
            color: var(--muted-foreground);
            background-color: var(--muted);
            padding: 0.25rem 0.5rem;
            border-radius: calc(var(--radius) / 2);
            font-size: 0.8rem;
            min-width: 200px;
            text-align: center;
        }

        /* Message */
        #message {
            position: fixed;
            top: 1rem;
            right: 1rem;
            background-color: var(--success-color);
            color: white;
            padding: 0.75rem 1rem;
            border-radius: var(--radius);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            opacity: 0;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 50;
        }

        #message.show {
            opacity: 1;
            transform: translateY(0);
        }

        /* Material Icons */
        .material-icons {
            font-family: 'Material Icons';
            font-weight: normal;
            font-style: normal;
            font-size: 1.25rem;
            line-height: 1;
            letter-spacing: normal;
            text-transform: none;
            display: inline-block;
            white-space: nowrap;
            word-wrap: normal;
            direction: ltr;
            font-feature-settings: 'liga';
            -webkit-font-feature-settings: 'liga';
            -webkit-font-smoothing: antialiased;
        }

        /* Layer Sidebar Styles */
        .layer-sidebar {
            background-color: var(--card);
            border-left: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            box-shadow: -4px 0 6px -1px rgba(0, 0, 0, 0.1), -2px 0 4px -1px rgba(0, 0, 0, 0.06);
            z-index: 20;
            width: 280px;
            transition: width 0.3s ease;
        }

        .layer-sidebar.collapsed {
            width: 50px;
        }

        .layer-sidebar-header {
            background-color: var(--muted);
            border-bottom: 1px solid var(--border);
            padding: 1rem;
            min-height: 74px;
            display: flex;
            align-items: center;
        }

        .layer-sidebar-header-content {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            width: 100%;
        }

        .layer-sidebar-header h3 {
            font-size: 1rem;
            font-weight: 600;
            color: var(--foreground);
            margin: 0;
            flex: 1;
        }

        .layer-sidebar-collapse {
            padding: 0.375rem;
            background: transparent;
            border: none;
            color: var(--muted-foreground);
            cursor: pointer;
            border-radius: 0.375rem;
            transition: all 0.2s ease;
        }

        .layer-sidebar-collapse:hover {
            background-color: var(--accent);
            color: var(--accent-foreground);
        }

        .layer-sidebar.collapsed .layer-sidebar-collapse .material-icons {
            transform: rotate(180deg);
        }

        .layer-sidebar-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .layer-sidebar.collapsed .layer-sidebar-content {
            display: none;
        }

        .layer-list {
            flex: 1;
            overflow-y: auto;
            padding: 0.5rem;
        }

        .layer-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            background-color: var(--background);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .layer-item:hover {
            background-color: var(--accent);
            border-color: var(--primary);
        }

        .layer-item.selected {
            background-color: var(--primary);
            color: var(--primary-foreground);
            border-color: var(--primary);
        }

        .layer-item.background-layer {
            opacity: 0.8;
        }

        .layer-info {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            flex: 1;
        }

        .layer-icon {
            font-size: 1.25rem;
            color: var(--muted-foreground);
        }

        .layer-item.selected .layer-icon {
            color: var(--primary-foreground);
        }

        .layer-name {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--foreground);
            flex: 1;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .layer-item.selected .layer-name {
            color: var(--primary-foreground);
        }

        .layer-controls {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .layer-visibility-toggle {
            padding: 0.25rem;
            background: transparent;
            border: none;
            color: var(--muted-foreground);
            cursor: pointer;
            border-radius: 0.25rem;
            transition: all 0.2s ease;
        }

        .layer-visibility-toggle:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .layer-visibility-toggle.hidden .material-icons {
            opacity: 0.3;
        }

        .layer-item.selected .layer-visibility-toggle {
            color: var(--primary-foreground);
        }

        .layer-actions {
            padding: 1rem;
            border-top: 1px solid var(--border);
        }

        .layer-actions .btn {
            width: 100%;
            justify-content: center;
            gap: 0.5rem;
            font-size: 0.875rem;
        }

        /* ëª¨ë°”ì¼ ì „ìš© ë ˆì´ì•„ì›ƒ - User Agent ê¸°ë°˜ */
        .mobile-device .sidebar {
            position: fixed;
            left: -280px;
            height: 100vh;
            z-index: 30;
            transition: left 0.3s ease;
        }

        .mobile-device .sidebar.mobile-open {
            left: 0;
        }

        .mobile-device .sidebar.collapsed {
            left: -60px;
        }

        .mobile-device .main-content {
            width: 100%;
        }

        .mobile-device .layer-sidebar {
            position: fixed;
            right: -280px;
            height: 100vh;
            z-index: 30;
            transition: right 0.3s ease;
        }

        .mobile-device .layer-sidebar.mobile-open {
            right: 0;
        }

        .mobile-device .layer-sidebar.collapsed {
            right: -50px;
        }

        .mobile-device .mobile-overlay {
            position: fixed;
            inset: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 25;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .mobile-device .mobile-overlay.show {
            opacity: 1;
            pointer-events: auto;
        }

        .mobile-device .top-bar {
            padding-left: 3rem;
        }

        .mobile-device .mobile-menu-btn {
            position: fixed;
            top: 1rem;
            left: 1rem;
            z-index: 35;
            background-color: var(--primary);
            color: var(--primary-foreground);
            border: none;
            padding: 0.75rem;
            border-radius: var(--radius);
            cursor: pointer;
            display: block !important;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }

        .mobile-device .mobile-menu-btn:hover {
            background-color: var(--primary);
            transform: scale(1.05);
        }

        .mobile-device .mobile-menu-btn:active {
            transform: scale(0.95);
        }

        /* ë°ìŠ¤í¬í†±ì—ì„œëŠ” ëª¨ë°”ì¼ ìš”ì†Œë“¤ ìˆ¨ê¸°ê¸° */
        .desktop-device .mobile-menu-btn {
            display: none !important;
        }

        .desktop-device .mobile-overlay {
            display: none;
        }

        /* ëª¨ë°”ì¼ í„°ì¹˜ ìµœì í™” */
        .mobile-device button, 
        .mobile-device select, 
        .mobile-device input[type="range"],
        .mobile-device .button {
            min-height: 44px !important;
            min-width: 44px !important;
            font-size: 16px !important; /* iOS ì¤Œ ë°©ì§€ */
            padding: 0.75rem 1rem !important;
        }

        .mobile-device .control-group button {
            padding: 0.875rem 1.25rem !important;
            font-size: 0.9rem !important;
            border-radius: 8px !important;
        }

        .mobile-device .color-option {
            width: 48px !important;
            height: 48px !important;
            border-radius: 50% !important;
            border: 3px solid var(--border) !important;
            margin: 0.25rem !important;
        }

        .mobile-device .size-display,
        .mobile-device .number-count {
            font-size: 1.1rem !important;
            padding: 0.75rem !important;
            min-height: 44px !important;
        }

        /* ëª¨ë°”ì¼ ì „ìš© í”Œë¡œíŒ… ë²„íŠ¼ */
        .mobile-device .floating-action-buttons {
            position: fixed;
            bottom: 140px; /* í•˜ë‹¨ íˆ´ë°” ìœ„ìª½ìœ¼ë¡œ ì´ë™ */
            right: 1rem; /* ì˜¤ë¥¸ìª½ ì—¬ë°± ì¤„ì„ */
            z-index: 40;
            display: flex;
            flex-direction: column;
            gap: 0.5rem; /* ê°„ê²© ì¤„ì„ */
        }

        .mobile-device .fab {
            width: 48px; /* í¬ê¸° ì¤„ì„ */
            height: 48px; /* í¬ê¸° ì¤„ì„ */
            border-radius: 50%;
            background-color: var(--primary);
            color: var(--primary-foreground);
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem; /* ì•„ì´ì½˜ í¬ê¸° ì¡°ì • */
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.15);
            cursor: pointer;
            transition: all 0.2s ease;
            backdrop-filter: blur(10px);
        }

        .mobile-device .fab:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
        }

        .mobile-device .fab:active {
            transform: scale(0.95);
        }

        .mobile-device .fab.save {
            background-color: var(--success-color);
        }

        .mobile-device .fab.undo {
            background-color: var(--muted);
            color: var(--muted-foreground);
        }

        /* ëª¨ë°”ì¼ì—ì„œ ìº”ë²„ìŠ¤ í„°ì¹˜ ë™ì‘ ìµœì í™” */
        .mobile-device .canvas-container {
            touch-action: none; /* ë¸Œë¼ìš°ì € ê¸°ë³¸ í„°ì¹˜ ë™ì‘ ë°©ì§€ */
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        .mobile-device #imageCanvas {
            touch-action: none;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        /* ëª¨ë°”ì¼ ì „ìš© í•˜ë‹¨ íˆ´ë°” */
        .mobile-device .mobile-toolbar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: var(--card);
            border-top: 1px solid var(--border);
            padding: 1rem;
            z-index: 30;
            display: flex;
            justify-content: space-around;
            align-items: center;
            backdrop-filter: blur(10px);
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
        }

        .mobile-device .mobile-toolbar .toolbar-button {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.25rem;
            padding: 0.5rem;
            border: none;
            background: transparent;
            color: var(--muted-foreground);
            font-size: 0.75rem;
            cursor: pointer;
            min-width: 44px;
            min-height: 44px;
            border-radius: 8px;
            transition: all 0.2s ease;
        }

        .mobile-device .mobile-toolbar .toolbar-button.active {
            background-color: var(--primary);
            color: var(--primary-foreground);
        }

        .mobile-device .mobile-toolbar .toolbar-button:hover {
            background-color: var(--muted);
            color: var(--foreground);
        }

        /* ëª¨ë°”ì¼ì—ì„œ ë©”ì¸ ì½˜í…ì¸  í•˜ë‹¨ íŒ¨ë”© (í•˜ë‹¨ íˆ´ë°” ê³µê°„ í™•ë³´) */
        .mobile-device .main-content {
            padding-bottom: 120px !important;
        }

        /* ëª¨ë°”ì¼ ì „ìš© ëª¨ë“œ ì„ íƒ íŒ¨ë„ */
        .mobile-device .mobile-mode-panel {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: var(--card);
            border-radius: 12px;
            padding: 1.5rem;
            z-index: 50;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            max-width: 90vw;
            max-height: 80vh;
            overflow-y: auto;
            display: none;
        }

        .mobile-device .mobile-mode-panel.show {
            display: block;
        }

        .mobile-device .mode-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-top: 1rem;
        }

        .mobile-device .mode-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 1.5rem 1rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            min-height: 100px;
            background-color: var(--background);
        }

        .mobile-device .mode-card:hover,
        .mobile-device .mode-card.active {
            border-color: var(--primary);
            background-color: var(--primary);
            color: var(--primary-foreground);
        }

        .mobile-device .mode-card .material-icons {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .mobile-device .mode-card .mode-name {
            font-size: 0.9rem;
            font-weight: 500;
            text-align: center;
        }

        /* Hide elements initially if no image */
        .canvas-container.empty {
            background: transparent;
            box-shadow: none;
            padding: 2rem;
            text-align: center;
        }

        .empty-state {
            color: var(--muted-foreground);
            font-size: 1.125rem;
        }

        .empty-state .material-icons {
            font-size: 3rem;
            opacity: 0.5;
            margin-bottom: 1rem;
        }
    </style>
    
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3945001668113003" crossorigin="anonymous"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-4JDFWP6MTQ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-4JDFWP6MTQ');
    </script>
</head>
<body>
    <div class="app-container">
        <!-- Mobile Menu Button -->
        <button class="mobile-menu-btn" id="mobileMenuBtn" style="display: none;">
            <span class="material-icons">menu</span>
        </button>

        <!-- Mobile Overlay -->
        <div class="mobile-overlay" id="mobileOverlay"></div>

        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <!-- Sidebar Header -->
            <div class="sidebar-header">
                <div class="logo-section">
                    <span class="material-icons logo-icon">edit</span>
                    <h1 class="logo-text">AnnotateShot</h1>
                </div>
            </div>

            <!-- Sidebar Content -->
            <div class="sidebar-content">
                <!-- File Operations -->
                <div class="tool-panel">
                    <div class="panel-title">
                        <span class="material-icons">folder_open</span>
                        <span data-lang-key="fileOperations">íŒŒì¼ ì‘ì—…</span>
                    </div>
                    <div class="btn-group">
                        <input type="file" id="imageLoader" accept="image/*" aria-label="Upload image file">
                        <div class="btn-row">
                            <button class="btn" id="clipboardButton" aria-label="Paste image from clipboard" title="Paste from Clipboard" style="flex: 1; height: 2.5rem;">
                                <span class="material-icons">content_paste</span>
                                <span data-lang-key="pasteFromClipboard">í´ë¦½ë³´ë“œì—ì„œ ê°€ì ¸ì˜¤ê¸°</span>
                            </button>
                            <button class="btn btn-icon success" id="saveButton" aria-label="Save annotated image" title="Save Image">
                                <span class="material-icons">download</span>
                            </button>
                            <button class="btn btn-icon" id="copyToClipboardButton" aria-label="Copy to clipboard" title="Copy to Clipboard">
                                <span class="material-icons">content_copy</span>
                            </button>
                            <button class="btn btn-icon" id="undoButton" aria-label="Undo last action">
                                <span class="material-icons">undo</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Canvas Settings -->
                <div class="tool-panel">
                    <div class="panel-title">
                        <span class="material-icons">palette</span>
                        <span data-lang-key="canvasSettings">ìº”ë²„ìŠ¤ ì„¤ì •</span>
                    </div>
                    <div class="style-section">
                        <div class="style-subtitle" data-lang-key="canvasMode">ìº”ë²„ìŠ¤ ëª¨ë“œ</div>
                        <select id="canvasModeSelector" aria-label="Select canvas mode">
                            <option value="single" data-lang-key="singleImageMode">ì‹±ê¸€ ì´ë¯¸ì§€ í¸ì§‘</option>
                            <option value="multi" data-lang-key="multiImageMode">ë¹ˆ ìº”ë²„ìŠ¤ (ë©€í‹° ì´ë¯¸ì§€)</option>
                        </select>
                    </div>
                    <div class="style-section" id="backgroundColorSection" style="display: none;">
                        <div class="style-subtitle" data-lang-key="backgroundColor">ë°°ê²½ìƒ‰</div>
                        <select id="backgroundColorSelector" aria-label="Select background color">
                            <option value="" data-lang-key="pleaseSelect">ë°°ê²½ìƒ‰ì„ ì„ íƒí•´ì£¼ì„¸ìš”</option>
                            <option value="transparent" data-lang-key="transparent">íˆ¬ëª…</option>
                            <option value="white" data-lang-key="white">í°ìƒ‰</option>
                            <option value="light-gray" data-lang-key="lightGray">ì—°í•œ íšŒìƒ‰</option>
                            <option value="gray" data-lang-key="gray">íšŒìƒ‰</option>
                            <option value="dark-gray" data-lang-key="darkGray">ì§™ì€ íšŒìƒ‰</option>
                        </select>
                    </div>
                    <div class="style-section" id="canvasSizeSection" style="display: none;">
                        <div class="style-subtitle" data-lang-key="canvasSize">ìº”ë²„ìŠ¤ í¬ê¸°</div>
                        <select id="canvasSizeSelector" aria-label="Select canvas size">
                            <option value="" data-lang-key="pleaseSelectSize">ìº”ë²„ìŠ¤ í¬ê¸°ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</option>
                            <option value="1920x1080" data-lang-key="size1920x1080">Full HD (1920Ã—1080)</option>
                            <option value="1280x720" data-lang-key="size1280x720">HD (1280Ã—720)</option>
                            <option value="1200x800" data-lang-key="size1200x800">ì›¹ í‘œì¤€ (1200Ã—800)</option>
                            <option value="800x600" data-lang-key="size800x600">í´ë˜ì‹ (800Ã—600)</option>
                            <option value="a4-landscape" data-lang-key="sizeA4Landscape">A4 ê°€ë¡œ (297Ã—210mm)</option>
                            <option value="a4-portrait" data-lang-key="sizeA4Portrait">A4 ì„¸ë¡œ (210Ã—297mm)</option>
                            <option value="custom" data-lang-key="sizeCustom">ì‚¬ìš©ì ì •ì˜</option>
                        </select>
                        <div id="customSizeSection" style="display: none; margin-top: 10px;">
                            <div style="display: flex; gap: 5px; align-items: center;">
                                <input type="number" id="customWidth" placeholder="ê°€ë¡œ" min="100" max="2000" style="width: 70px; padding: 5px; border: 1px solid #ddd; border-radius: 3px;">
                                <span>Ã—</span>
                                <input type="number" id="customHeight" placeholder="ì„¸ë¡œ" min="100" max="2000" style="width: 70px; padding: 5px; border: 1px solid #ddd; border-radius: 3px;">
                                <button id="applyCustomSize" style="padding: 5px 10px; border: 1px solid #ddd; border-radius: 3px; background: #f5f5f5; cursor: pointer;" data-lang-key="apply">ì ìš©</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Drawing Mode -->
                <div class="tool-panel">
                    <div class="panel-title">
                        <span class="material-icons">brush</span>
                        <span data-lang-key="annotationMode">ì£¼ì„ ëª¨ë“œ</span>
                    </div>
                    <div class="btn-group">
                        <select id="modeSelector" aria-label="Select annotation mode">
                            <option value="number" data-lang-key="numberMode">ìˆ«ì ì…ë ¥ ëª¨ë“œ</option>
                            <option value="shape" data-lang-key="shapeMode">ë„í˜• ëª¨ë“œ</option>
                            <option value="text" data-lang-key="textMode">í…ìŠ¤íŠ¸ ëª¨ë“œ</option>
                            <option value="emoji" data-lang-key="emojiMode">ì´ëª¨ì§€ ëª¨ë“œ</option>
                            <option value="crop" data-lang-key="cropMode">í¬ë¡­ ëª¨ë“œ</option>
                        </select>
                    </div>
                </div>

                <!-- Style Panel -->
                <div class="tool-panel">
                    <div class="panel-title">
                        <span class="material-icons">palette</span>
                        <span data-lang-key="style">ìŠ¤íƒ€ì¼</span>
                    </div>
                    
                    <!-- Color Section -->
                    <div class="style-section" id="colorSection">
                        <div class="style-subtitle" data-lang-key="color">ìƒ‰ìƒ</div>
                        <select id="colorSelector" aria-label="Select annotation color">
                            <option value="#FF0000" data-lang-key="red">ë¹¨ê°„ìƒ‰</option>
                            <option value="#FF8000" data-lang-key="orange">ì£¼í™©ìƒ‰</option>
                            <option value="#00FF00" data-lang-key="green">ë…¹ìƒ‰</option>
                            <option value="#0000FF" data-lang-key="blue">íŒŒë‘ìƒ‰</option>
                        </select>
                    </div>
                    
                    <!-- Size Section -->
                    <div class="style-section" id="sizeSection">
                        <div class="style-subtitle" data-lang-key="size">í¬ê¸°</div>
                        <select id="sizeSelector" aria-label="Select annotation size">
                            <option value="10">10px</option>
                            <option value="15">15px</option>
                            <option value="20" selected>20px</option>
                            <option value="25">25px</option>
                            <option value="30">30px</option>
                            <option value="35">35px</option>
                            <option value="40">40px</option>
                            <option value="45">45px</option>
                            <option value="50">50px</option>
                            <option value="55">55px</option>
                            <option value="60">60px</option>
                            <option value="65">65px</option>
                            <option value="70">70px</option>
                        </select>
                    </div>
                    
                    <!-- Line Width Section (Shape mode only) -->
                    <div class="style-section" id="lineWidthSection" style="display: none;">
                        <div class="style-subtitle" data-lang-key="lineWidth">êµµê¸°</div>
                        <select id="lineWidthSelector" aria-label="Select line width">
                            <option value="1" data-lang-key="thin">ì–‡ìŒ</option>
                            <option value="2" selected data-lang-key="normal">ë³´í†µ</option>
                            <option value="4" data-lang-key="thick">ë‘êº¼ì›€</option>
                        </select>
                    </div>
                    
                    <!-- Shape Section (Shape mode only) -->
                    <div class="style-section" id="shapeSection" style="display: none;">
                        <div class="style-subtitle" data-lang-key="shape">ëª¨ì–‘</div>
                        <select id="shapeSelector" aria-label="Select shape type">
                            <option value="rectangle" data-lang-key="rectangle">ì‚¬ê°í˜•</option>
                            <option value="circle" data-lang-key="circle">ì›</option>
                            <option value="arrow" data-lang-key="arrow">í™”ì‚´í‘œ</option>
                        </select>
                    </div>
                    
                    <!-- Fill Section (Shape mode only, not for arrows) -->
                    <div class="style-section" id="fillSection" style="display: none;">
                        <div class="style-subtitle" data-lang-key="fill">ì±„ìš°ê¸°</div>
                        <select id="fillSelector" aria-label="Select fill type">
                            <option value="none" data-lang-key="fillNone">í…Œë‘ë¦¬ë§Œ</option>
                            <option value="solid" data-lang-key="fillSolid">ë‹¨ìƒ‰ ì±„ìš°ê¸°</option>
                            <option value="blur" data-lang-key="fillBlur">íë¦¼ íš¨ê³¼</option>
                            <option value="mosaic" data-lang-key="fillMosaic">ëª¨ìì´í¬</option>
                        </select>
                    </div>
                    
                    <!-- Emoji Section (Emoji mode only) -->
                    <div class="style-section" id="emojiSection" style="display: none;">
                        <div class="style-subtitle" data-lang-key="emojiType">ì´ëª¨ì§€ ì¢…ë¥˜</div>
                        <select id="emojiSelector" aria-label="Select emoji">
                            <option value="ğŸ˜€">ğŸ˜€</option>
                            <option value="ğŸ˜">ğŸ˜</option>
                            <option value="ğŸ¤”">ğŸ¤”</option>
                            <option value="ğŸ‘">ğŸ‘</option>
                            <option value="ğŸ‘">ğŸ‘</option>
                            <option value="â¤ï¸">â¤ï¸</option>
                            <option value="â­">â­</option>
                            <option value="ğŸ”¥">ğŸ”¥</option>
                            <option value="ğŸ’¯">ğŸ’¯</option>
                            <option value="âœ…">âœ…</option>
                            <option value="âŒ">âŒ</option>
                            <option value="âš ï¸">âš ï¸</option>
                        </select>
                    </div>

                    <!-- Crop Section (Crop mode only) -->
                    <div class="style-section" id="cropSection" style="display: none;">
                        <div class="style-subtitle" data-lang-key="cropStyle">í¬ë¡­ ìŠ¤íƒ€ì¼</div>
                        <select id="cropStyleSelector" aria-label="Select crop style">
                            <option value="basic" data-lang-key="cropBasic">ê¸°ë³¸ í¬ë¡­</option>
                            <option value="torn" data-lang-key="cropTorn">ì°¢ì–´ì§„ ì¢…ì´</option>
                        </select>
                    </div>

                    <!-- Crop Controls Section -->
                    <div class="style-section" id="cropControlsSection" style="display: none;">
                        <div class="style-subtitle" data-lang-key="cropControls">í¬ë¡­ ì»¨íŠ¸ë¡¤</div>
                        <div class="btn-group">
                            <button id="applyCropButton" class="btn btn-primary" data-lang-key="applyCrop" disabled>í¬ë¡­ ì ìš©</button>
                        </div>
                        <div class="crop-info" id="cropInfo" style="display: none; margin-top: 8px; font-size: 12px; color: #666;">
                            <span data-lang-key="cropInstruction">ë“œë˜ê·¸í•˜ì—¬ í¬ë¡­ ì˜ì—­ì„ ì„ íƒí•˜ì„¸ìš”</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sidebar Footer -->
            <div class="sidebar-footer" style="padding: 1rem; border-top: 1px solid var(--border);">
                <div class="btn-group">
                    
                    <!-- Language Selector -->
                    <div style="margin-top: 1rem;">
                         <label for="languageSelector" style="font-size: 0.875rem; color: var(--muted-foreground); margin-bottom: 0.5rem; display: block;">Language</label>
                         <select id="languageSelector" aria-label="Select language" style="width: 100%;">
                             <option value="ko">í•œêµ­ì–´</option>
                             <option value="en">English</option>
                         </select>
                    </div>
                    
                    <!-- Footer Links -->
                    <div class="footer-links" style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border);">
                        <a href="changelog.html" target="_blank" class="btn footer-link">
                            <span class="material-icons">description</span>
                            <span data-lang-key="releaseNotes">Release Notes</span>
                        </a>
                        
                        <a href="delcodelinenum.html" class="btn footer-link">
                            <span class="material-icons">code</span>
                            <span data-lang-key="codeLineRemover">Code Line Remover</span>
                        </a>
                        
                        <a href="index-legacy.html" class="btn footer-link">
                            <span class="material-icons">history</span>
                            <span data-lang-key="legacyVersion">Legacy Version</span>
                        </a>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Top Bar -->
            <header class="top-bar">
                <h2 data-lang-key="editImage">ì´ë¯¸ì§€ í¸ì§‘</h2>
                <div class="top-bar-actions">
                    <!-- Chrome Extension Link -->
                    <a href="https://chromewebstore.google.com/detail/annotateshot-capture/edngphlkihgcpcolnjadgopgkpfhdcce" target="_blank" class="chrome-extension-link" title="Chrome Extensionìœ¼ë¡œ ì›¹í˜ì´ì§€ ìº¡ì²˜í•˜ê¸°" style="display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem 1.25rem; background: linear-gradient(135deg, #4285f4, #34a853); color: white; text-decoration: none; border-radius: 6px; font-size: 0.875rem; margin-right: 1rem; transition: all 0.2s ease; white-space: nowrap;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2c5.52 0 10 4.48 10 10s-4.48 10-10 10S2 17.52 2 12 6.48 2 12 2zm3.5 6L12 10.5 8.5 8 6 12l2.5 4 3.5-2.5L15.5 16l2.5-4-2.5-4z"/>
                        </svg>
                        <span data-lang-key="chromeExtension" class="chrome-extension-text">Chrome Extension</span>
                    </a>
                    <label for="resizeSelector" style="font-size: 0.875rem; color: var(--muted-foreground); margin-right: 0.5rem; pointer-events: none; white-space: nowrap;" data-lang-key="imageSize">ì´ë¯¸ì§€ í¬ê¸°:</label>
                    <select id="resizeSelector" aria-label="Select image resize option" class="top-resize-selector" onclick="event.stopPropagation();">
                        <option value="default" data-lang-key="autoResize">ìë™ ë¦¬ì‚¬ì´ì¦ˆ (ê¸°ë³¸)</option>
                        <option value="original" data-lang-key="originalSize">ì›ë³¸</option>
                        <option value="300" data-lang-key="width300">ë„ˆë¹„ 300</option>
                        <option value="600" data-lang-key="width600">ë„ˆë¹„ 600</option>
                        <option value="900" data-lang-key="width900">ë„ˆë¹„ 900</option>
                        <option value="scale30" data-lang-key="scale30">ì›ë³¸ ëŒ€ë¹„ 30% ì¶•ì†Œ</option>
                        <option value="scale50" data-lang-key="scale50">ì›ë³¸ ëŒ€ë¹„ 50% ì¶•ì†Œ</option>
                        <option value="scale70" data-lang-key="scale70">ì›ë³¸ ëŒ€ë¹„ 70% ì¶•ì†Œ</option>
                    </select>
                    <button class="btn btn-icon" id="themeToggle" aria-label="Toggle theme">
                        <span class="material-icons">dark_mode</span>
                    </button>
                </div>
            </header>

            <!-- Canvas Area -->
            <div class="canvas-area">
                <div class="canvas-container empty" id="canvasContainer">
                    <div class="empty-state" id="emptyState">
                        <div class="material-icons">image</div>
                        <div id="uploadPromptText" data-lang-key="uploadImagePrompt">ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ê±°ë‚˜ í´ë¦½ë³´ë“œì—ì„œ ë¶™ì—¬ë„£ê¸°í•˜ì„¸ìš”</div>
                    </div>
                    <canvas id="imageCanvas" style="display: none;"></canvas>
                </div>
            </div>

            <!-- Status Bar -->
            <footer class="status-bar">
                <div class="status-info" id="statusInfo">
                    <span id="statusText" data-lang-key="mouseMovePrompt">ë§ˆìš°ìŠ¤ë¥¼ ì›€ì§ì—¬ë³´ì„¸ìš”</span>
                </div>
            </footer>
        </main>

        <!-- Right Layer Sidebar -->
        <aside class="layer-sidebar" id="layerSidebar">
            <div class="layer-sidebar-header">
                <div class="layer-sidebar-header-content">
                    <span class="material-icons">layers</span>
                    <h3 data-lang-key="layers">ë ˆì´ì–´</h3>
                </div>
            </div>
            
            <div class="layer-sidebar-content">
                <div class="layer-list" id="layerList">
                    <div class="layer-item background-layer">
                        <div class="layer-info">
                            <span class="material-icons layer-icon">image</span>
                            <span class="layer-name" data-lang-key="backgroundLayer">ë°°ê²½ ì´ë¯¸ì§€</span>
                        </div>
                        <div class="layer-controls">
                            <button class="layer-visibility-toggle" aria-label="Toggle visibility">
                                <span class="material-icons">visibility</span>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="layer-actions">
                    <button class="btn btn-sm" id="clearAllLayers" data-lang-key="clearAllLayers">
                        <span class="material-icons">clear_all</span>
                        ëª¨ë“  ë ˆì´ì–´ ì§€ìš°ê¸°
                    </button>
                </div>
            </div>
        </aside>
    </div>

    <!-- Message -->
    <div id="message"></div>

    <script src="./src/main.js"></script>
    
    <script>
        // Theme Toggle Functionality
        function initializeTheme() {
            const themeToggle = document.getElementById('themeToggle');
            const body = document.body;
            const themeIcon = themeToggle.querySelector('.material-icons');
            
            // Check for saved theme or default to light
            const savedTheme = localStorage.getItem('theme') || 'light';
            if (savedTheme === 'dark') {
                body.classList.add('dark');
                themeIcon.textContent = 'light_mode';
            } else {
                themeIcon.textContent = 'dark_mode';
            }
            
            themeToggle.addEventListener('click', () => {
                body.classList.toggle('dark');
                const isDark = body.classList.contains('dark');
                themeIcon.textContent = isDark ? 'light_mode' : 'dark_mode';
                localStorage.setItem('theme', isDark ? 'dark' : 'light');
            });
        }

        // Mobile Sidebar Functionality - User Agent ê¸°ë°˜
        function initializeSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const mobileOverlay = document.getElementById('mobileOverlay');
            
            // User Agent ê¸°ë°˜ ëª¨ë°”ì¼ ê°ì§€ (main.jsì—ì„œ ì´ë¯¸ ì„¤ì •ë¨)
            function isMobileDevice() {
                const userAgent = navigator.userAgent.toLowerCase();
                const mobileKeywords = [
                    'android', 'webos', 'iphone', 'ipad', 'ipod', 
                    'blackberry', 'windows phone', 'mobile', 'opera mini'
                ];
                return mobileKeywords.some(keyword => userAgent.includes(keyword));
            }
            
            const isMobile = isMobileDevice();
            
            // ëª¨ë°”ì¼ ê¸°ê¸°ì—ì„œë§Œ ëª¨ë°”ì¼ UI í™œì„±í™”
            if (isMobile) {
                console.log('ëª¨ë°”ì¼ UI í™œì„±í™” - ì‚¬ì´ë“œë°” ê¸°ëŠ¥ ì´ˆê¸°í™”');
                
                mobileMenuBtn.addEventListener('click', () => {
                    sidebar.classList.toggle('mobile-open');
                    mobileOverlay.classList.toggle('show');
                });
                
                mobileOverlay.addEventListener('click', () => {
                    sidebar.classList.remove('mobile-open');
                    mobileOverlay.classList.remove('show');
                });
                
                // ëª¨ë°”ì¼ì—ì„œ ë’¤ë¡œê°€ê¸° ë²„íŠ¼ìœ¼ë¡œ ì‚¬ì´ë“œë°” ë‹«ê¸°
                window.addEventListener('popstate', () => {
                    sidebar.classList.remove('mobile-open');
                    mobileOverlay.classList.remove('show');
                });
            } else {
                console.log('ë°ìŠ¤í¬í†± UI - ëª¨ë°”ì¼ ê¸°ëŠ¥ ë¹„í™œì„±í™”');
            }
            
            // ìº”ë²„ìŠ¤ ë¦¬ì‚¬ì´ì¦ˆëŠ” ëª¨ë“  ê¸°ê¸°ì—ì„œ ë™ì‘ (ë¸Œë¼ìš°ì € í¬ê¸° ë³€ê²½ ì‹œ)
            window.addEventListener('resize', () => {
                // Canvas resize triggerëŠ” ìœ ì§€
                if (typeof window.triggerCanvasResize === 'function') {
                    clearTimeout(window.resizeTimeout);
                    window.resizeTimeout = setTimeout(() => {
                        window.triggerCanvasResize();
                    }, 100);
                }
            });
        }

        // Layer Sidebar Functionality
        function initializeLayerSidebar() {
            const layerSidebar = document.getElementById('layerSidebar');
            const layerList = document.getElementById('layerList');
            const clearAllLayersBtn = document.getElementById('clearAllLayers');
            
            // Initialize background layer visibility toggle
            const backgroundLayerToggle = layerList.querySelector('.background-layer .layer-visibility-toggle');
            if (backgroundLayerToggle) {
                backgroundLayerToggle.addEventListener('click', (e) => {
                    e.stopPropagation();
                    toggleBackgroundLayerVisibility();
                });
            }
            
            // Clear all layers functionality
            clearAllLayersBtn.addEventListener('click', () => {
                if (confirm('ëª¨ë“  ì£¼ì„ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    if (typeof window.clearAllAnnotations === 'function') {
                        window.clearAllAnnotations();
                    } else {
                        console.error('clearAllAnnotations function not available');
                    }
                }
            });
            
            // Update layer list based on new layer system
            function updateLayerList() {
                console.log('Updating layer list...');
                
                // Clear existing layers
                const existingLayers = layerList.querySelectorAll('.layer-item');
                existingLayers.forEach(item => item.remove());
                
                // Get data from main.js
                const layers = window.layers || [];
                const imageLayers = window.imageLayers || [];
                console.log('Layers:', layers.length, 'ImageLayers:', imageLayers.length);
                
                // 1. Add background layer (solid color)
                addBackgroundLayer();
                
                // 2. Add image layers
                imageLayers.forEach((imageLayer, index) => {
                    addImageLayerToUI(imageLayer, index);
                });
                
                // 3. Add annotation layers in reverse order (top layer first in UI)
                const annotationLayers = layers.filter(layer => layer.type !== 'background');
                for (let i = annotationLayers.length - 1; i >= 0; i--) {
                    const layer = annotationLayers[i];
                    addAnnotationLayerToUI(layer, i);
                }
                
                console.log('Layer list updated successfully');
            }
            
            function addBackgroundLayer() {
                const backgroundItem = document.createElement('div');
                backgroundItem.className = 'layer-item background-layer';
                backgroundItem.setAttribute('data-layer-type', 'background');
                
                const layerContent = document.createElement('div');
                layerContent.className = 'layer-info';
                
                const icon = document.createElement('span');
                icon.className = 'material-icons layer-icon';
                icon.textContent = 'layers';
                
                const name = document.createElement('span');
                name.className = 'layer-name';
                name.textContent = 'ë°°ê²½';
                
                const controls = document.createElement('div');
                controls.className = 'layer-controls';
                
                // ë°°ê²½ ë ˆì´ì–´ëŠ” í•­ìƒ ë³´ì„, ì‚­ì œ ë¶ˆê°€
                const visibilityBtn = document.createElement('button');
                visibilityBtn.className = 'layer-visibility-toggle';
                visibilityBtn.innerHTML = '<span class="material-icons">visibility</span>';
                visibilityBtn.disabled = true;
                visibilityBtn.style.opacity = '0.3';
                
                controls.appendChild(visibilityBtn);
                
                layerContent.appendChild(icon);
                layerContent.appendChild(name);
                backgroundItem.appendChild(layerContent);
                backgroundItem.appendChild(controls);
                
                layerList.appendChild(backgroundItem);
            }
            
            function addImageLayerToUI(imageLayer, index) {
                const layerItem = document.createElement('div');
                layerItem.className = 'layer-item image-layer';
                layerItem.setAttribute('data-image-layer-id', imageLayer.id);
                
                const layerContent = document.createElement('div');
                layerContent.className = 'layer-info';
                
                const icon = document.createElement('span');
                icon.className = 'material-icons layer-icon';
                icon.textContent = 'image';
                
                const name = document.createElement('span');
                name.className = 'layer-name';
                name.textContent = `ì´ë¯¸ì§€ ë ˆì´ì–´ ${index + 1}`;
                
                const controls = document.createElement('div');
                controls.className = 'layer-controls';
                
                // Visibility toggle
                const visibilityBtn = document.createElement('button');
                visibilityBtn.className = 'layer-visibility-toggle';
                const visibilityIcon = imageLayer.visible !== false ? 'visibility' : 'visibility_off';
                visibilityBtn.innerHTML = `<span class="material-icons">${visibilityIcon}</span>`;
                if (imageLayer.visible === false) {
                    visibilityBtn.classList.add('hidden');
                }
                visibilityBtn.onclick = (e) => {
                    e.stopPropagation();
                    toggleImageLayerVisibility(imageLayer.id);
                };
                
                // Delete button
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'layer-visibility-toggle';
                deleteBtn.innerHTML = '<span class="material-icons">delete</span>';
                deleteBtn.onclick = (e) => {
                    e.stopPropagation();
                    deleteImageLayer(imageLayer.id);
                };
                
                controls.appendChild(visibilityBtn);
                controls.appendChild(deleteBtn);
                
                layerContent.appendChild(icon);
                layerContent.appendChild(name);
                layerItem.appendChild(layerContent);
                layerItem.appendChild(controls);
                
                layerList.appendChild(layerItem);
            }
            
            function addAnnotationLayerToUI(layer, index) {
                const layerItem = createLayerItem(layer, index);
                layerList.appendChild(layerItem);
            }
            
            function createLayerItem(layer, displayIndex) {
                const layerItem = document.createElement('div');
                layerItem.className = 'layer-item annotation-layer';
                layerItem.dataset.layerId = layer.id;
                
                const layerInfo = document.createElement('div');
                layerInfo.className = 'layer-info';
                
                const icon = document.createElement('span');
                icon.className = 'material-icons layer-icon';
                icon.textContent = getLayerIcon(layer.type);
                
                const name = document.createElement('span');
                name.className = 'layer-name';
                name.textContent = layer.name || getLayerName(layer, displayIndex);
                
                const controls = document.createElement('div');
                controls.className = 'layer-controls';
                
                const visibilityToggle = document.createElement('button');
                visibilityToggle.className = 'layer-visibility-toggle';
                if (layer.visible === false) {
                    visibilityToggle.classList.add('hidden');
                }
                const visibilityIcon = layer.visible === false ? 'visibility_off' : 'visibility';
                visibilityToggle.innerHTML = `<span class="material-icons">${visibilityIcon}</span>`;
                visibilityToggle.addEventListener('click', (e) => {
                    e.stopPropagation();
                    toggleLayerVisibility(layer.id);
                });
                
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'layer-visibility-toggle';
                deleteBtn.innerHTML = '<span class="material-icons">delete</span>';
                deleteBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    deleteLayer(layer.id);
                });
                
                layerInfo.appendChild(icon);
                layerInfo.appendChild(name);
                controls.appendChild(visibilityToggle);
                controls.appendChild(deleteBtn);
                layerItem.appendChild(layerInfo);
                layerItem.appendChild(controls);
                
                // Layer click to select
                layerItem.addEventListener('click', () => {
                    selectLayerById(layer.id);
                });
                
                return layerItem;
            }
            
            function getLayerIcon(type) {
                const icons = {
                    number: 'looks_one',
                    shape: 'crop_square',
                    text: 'text_fields',
                    emoji: 'emoji_emotions'
                };
                return icons[type] || 'layers';
            }
            
            function getLayerName(annotation, index) {
                const typeNames = {
                    number: 'ìˆ«ì',
                    shape: 'ë„í˜•',
                    text: 'í…ìŠ¤íŠ¸',
                    emoji: 'ì´ëª¨ì§€'
                };
                const baseName = typeNames[annotation.type] || 'ìš”ì†Œ';
                return `${baseName} ${index + 1}`;
            }
            
            function selectLayer(index) {
                // Remove previous selection
                document.querySelectorAll('.layer-item.selected').forEach(item => {
                    item.classList.remove('selected');
                });
                
                // Select new layer
                const layerItem = document.querySelector(`[data-index="${index}"]`);
                if (layerItem) {
                    layerItem.classList.add('selected');
                }
            }
            
            function toggleAnnotationVisibility(index) {
                if (clicks[index]) {
                    clicks[index].visible = clicks[index].visible !== false ? false : true;
                    redrawCanvas();
                    updateLayerList();
                }
            }
            
            function deleteAnnotation(index) {
                if (clicks[index]) {
                    clicks.splice(index, 1);
                    redrawCanvas();
                    updateLayerList();
                }
            }
            
            
            // Background layer visibility toggle
            function toggleBackgroundLayerVisibility() {
                console.log('Toggling background layer visibility');
                if (window.layers) {
                    const backgroundLayer = window.layers.find(layer => layer.type === 'background');
                    console.log('Found background layer:', backgroundLayer);
                    if (backgroundLayer) {
                        backgroundLayer.visible = !backgroundLayer.visible;
                        console.log('New visibility state:', backgroundLayer.visible);
                        if (typeof window.redrawCanvas === 'function') {
                            window.redrawCanvas();
                        }
                        updateLayerList();
                    }
                }
            }
            
            // Layer visibility toggle by ID
            function toggleLayerVisibility(layerId) {
                if (window.layers) {
                    const layer = window.layers.find(l => l.id === layerId);
                    if (layer) {
                        layer.visible = !layer.visible;
                        if (typeof window.redrawCanvas === 'function') {
                            window.redrawCanvas();
                        }
                        updateLayerList();
                    }
                }
            }
            
            // Delete layer by ID
            function deleteLayer(layerId) {
                console.log('Deleting layer with ID:', layerId);
                if (window.layers) {
                    const layerIndex = window.layers.findIndex(l => l.id === layerId);
                    console.log('Found layer at index:', layerIndex);
                    if (layerIndex !== -1) {
                        const layer = window.layers[layerIndex];
                        console.log('Layer to delete:', layer);
                        
                        // Also remove from clicks array
                        const clickIndex = window.clicks.findIndex(click => click === layer.data);
                        console.log('Found corresponding click at index:', clickIndex);
                        console.log('Clicks array before:', window.clicks.length);
                        
                        if (clickIndex !== -1) {
                            window.clicks.splice(clickIndex, 1);
                        }
                        
                        console.log('Clicks array after:', window.clicks.length);
                        
                        window.layers.splice(layerIndex, 1);
                        console.log('Layers array after:', window.layers.length);
                        
                        if (typeof window.redrawCanvas === 'function') {
                            window.redrawCanvas();
                        }
                        updateLayerList();
                    }
                }
            }
            
            // Image layer control functions
            function toggleImageLayerVisibility(imageLayerId) {
                if (window.imageLayers) {
                    const imageLayer = window.imageLayers.find(layer => layer.id === imageLayerId);
                    if (imageLayer) {
                        imageLayer.visible = !imageLayer.visible;
                        if (typeof window.redrawCanvas === 'function') {
                            window.redrawCanvas();
                        }
                        updateLayerList();
                    }
                }
            }
            
            function deleteImageLayer(imageLayerId) {
                if (window.imageLayers) {
                    const layerIndex = window.imageLayers.findIndex(layer => layer.id === imageLayerId);
                    if (layerIndex !== -1) {
                        window.imageLayers.splice(layerIndex, 1);
                        
                        // Also remove from legacy layers system
                        if (window.layers) {
                            const legacyIndex = window.layers.findIndex(l => l.type === 'background');
                            if (legacyIndex !== -1) {
                                window.layers.splice(legacyIndex, 1);
                            }
                        }
                        
                        if (typeof window.redrawCanvas === 'function') {
                            window.redrawCanvas();
                        }
                        updateLayerList();
                    }
                }
            }
            
            // Select layer by ID
            function selectLayerById(layerId) {
                // Remove previous selection
                document.querySelectorAll('.layer-item.selected').forEach(item => {
                    item.classList.remove('selected');
                });
                
                // Select new layer
                const layerItem = document.querySelector(`[data-layer-id="${layerId}"]`);
                if (layerItem) {
                    layerItem.classList.add('selected');
                }
            }
            
            // Expose updateLayerList globally for main.js to call
            window.updateLayerList = updateLayerList;
        }

        // Canvas Container State Management
        function updateCanvasContainer() {
            const canvas = document.getElementById('imageCanvas');
            const container = document.getElementById('canvasContainer');
            const emptyState = document.getElementById('emptyState');
            
            if (canvas.width > 0 && canvas.height > 0) {
                container.classList.remove('empty');
                emptyState.style.display = 'none';
                canvas.style.display = 'block';
            } else {
                container.classList.add('empty');
                emptyState.style.display = 'block';
                canvas.style.display = 'none';
            }
        }

        // Mode-specific control visibility
        function updateControlsVisibility() {
            const modeSelector = document.getElementById('modeSelector');
            const colorSection = document.getElementById('colorSection');
            const sizeSection = document.getElementById('sizeSection');
            const lineWidthSection = document.getElementById('lineWidthSection');
            const shapeSection = document.getElementById('shapeSection');
            const fillSection = document.getElementById('fillSection');
            const emojiSection = document.getElementById('emojiSection');
            const cropSection = document.getElementById('cropSection');
            const cropControlsSection = document.getElementById('cropControlsSection');
            const shapeSelector = document.getElementById('shapeSelector');
            const stylePanel = document.querySelector('.tool-panel:has(#colorSection)');
            
            const currentMode = modeSelector.value;
            
            // Hide all sections first
            colorSection.style.display = 'none';
            sizeSection.style.display = 'none';
            lineWidthSection.style.display = 'none';
            shapeSection.style.display = 'none';
            fillSection.style.display = 'none';
            emojiSection.style.display = 'none';
            cropSection.style.display = 'none';
            cropControlsSection.style.display = 'none';
            
            // Reorder and show sections based on current mode
            switch(currentMode) {
                case 'number':
                    // ìˆ«ì ëª¨ë“œ: ìƒ‰ìƒ, í¬ê¸°
                    stylePanel.appendChild(colorSection);
                    stylePanel.appendChild(sizeSection);
                    colorSection.style.display = 'block';
                    sizeSection.style.display = 'block';
                    break;
                    
                case 'shape':
                    // ë„í˜• ëª¨ë“œ: ëª¨ì–‘, ìƒ‰ìƒ, êµµê¸°, ì±„ìš°ê¸° (í™”ì‚´í‘œ ì œì™¸)
                    stylePanel.appendChild(shapeSection);
                    stylePanel.appendChild(colorSection);
                    stylePanel.appendChild(lineWidthSection);
                    stylePanel.appendChild(fillSection);
                    
                    shapeSection.style.display = 'block';
                    colorSection.style.display = 'block';
                    lineWidthSection.style.display = 'block';
                    
                    // Show fill section only if not arrow
                    const currentShape = shapeSelector.value;
                    if (currentShape !== 'arrow') {
                        fillSection.style.display = 'block';
                    }
                    break;
                    
                case 'text':
                    // í…ìŠ¤íŠ¸ ëª¨ë“œ: ìƒ‰ìƒ, í¬ê¸°
                    stylePanel.appendChild(colorSection);
                    stylePanel.appendChild(sizeSection);
                    colorSection.style.display = 'block';
                    sizeSection.style.display = 'block';
                    break;
                    
                case 'emoji':
                    // ì´ëª¨ì§€ ëª¨ë“œ: ì´ëª¨ì§€ ì¢…ë¥˜, í¬ê¸° (ìƒ‰ìƒ ì œì™¸)
                    stylePanel.appendChild(emojiSection);
                    stylePanel.appendChild(sizeSection);
                    emojiSection.style.display = 'block';
                    sizeSection.style.display = 'block';
                    break;
                    
                case 'crop':
                    // í¬ë¡­ ëª¨ë“œ: í¬ë¡­ ìŠ¤íƒ€ì¼, ì»¨íŠ¸ë¡¤
                    stylePanel.appendChild(cropSection);
                    stylePanel.appendChild(cropControlsSection);
                    cropSection.style.display = 'block';
                    cropControlsSection.style.display = 'block';
                    
                    // í¬ë¡­ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
                    if (typeof updateCropButtonStates === 'function') {
                        updateCropButtonStates();
                    }
                    break;
            }
        }

        // Handle shape selector changes to update fill selector visibility
        function initializeModeControls() {
            const modeSelector = document.getElementById('modeSelector');
            const shapeSelector = document.getElementById('shapeSelector');
            
            // Update controls when mode changes
            modeSelector.addEventListener('change', () => {
                updateControlsVisibility();
                // Force sync with main.js mode variable
                if (window.currentMode !== undefined) {
                    window.currentMode = modeSelector.value;
                }
            });
            
            // Update fill section when shape changes
            shapeSelector.addEventListener('change', () => {
                const fillSection = document.getElementById('fillSection');
                const currentShape = shapeSelector.value;
                
                // Hide fill section for arrows since they don't support fill
                if (currentShape === 'arrow') {
                    fillSection.style.display = 'none';
                } else if (modeSelector.value === 'shape') {
                    fillSection.style.display = 'block';
                }
                
                // Force sync with main.js shape variable
                if (window.currentShape !== undefined) {
                    window.currentShape = shapeSelector.value;
                }
            });
            
            // Sync initial state with main.js variables
            if (window.currentMode !== undefined) {
                modeSelector.value = window.currentMode;
            }
            if (window.currentShape !== undefined) {
                shapeSelector.value = window.currentShape;
            }
            
            // Initialize visibility
            updateControlsVisibility();
        }

        // Status logging functionality
        function updateStatus(message) {
            const statusText = document.getElementById('statusText');
            if (statusText) {
                statusText.textContent = message;
            }
        }

        function initializeStatusLogging() {
            const canvas = document.getElementById('imageCanvas');
            const canvasContainer = document.getElementById('canvasContainer');
            
            // Track mouse movement on canvas area only (not on top-bar)
            canvasContainer.addEventListener('mousemove', (e) => {
                // Check if mouse is over top-bar area
                const topBar = document.querySelector('.top-bar');
                const topBarRect = topBar.getBoundingClientRect();
                
                if (e.clientY >= topBarRect.top && e.clientY <= topBarRect.bottom) {
                    return; // Don't track if mouse is over top-bar
                }
                
                const rect = canvas.getBoundingClientRect();
                const x = Math.round(e.clientX - rect.left);
                const y = Math.round(e.clientY - rect.top);
                
                if (x >= 0 && y >= 0 && x <= canvas.width && y <= canvas.height) {
                    updateStatus(`ì¢Œí‘œ: (${x}, ${y})`);
                } else {
                    updateStatus('ìº”ë²„ìŠ¤ ì˜ì—­ ì™¸ë¶€');
                }
            });

            // Track mouse leave
            canvasContainer.addEventListener('mouseleave', () => {
                updateStatus('ëŒ€ê¸° ì¤‘');
            });

            // Track canvas clicks
            canvas.addEventListener('click', (e) => {
                const rect = canvas.getBoundingClientRect();
                const x = Math.round(e.clientX - rect.left);
                const y = Math.round(e.clientY - rect.top);
                const modeSelector = document.getElementById('modeSelector');
                const currentMode = modeSelector.value;
                
                updateStatus(`${getModeDisplayName(currentMode)} ì¶”ê°€ë¨: (${x}, ${y})`);
                
                // Clear status after 3 seconds
                setTimeout(() => {
                    updateStatus('ëŒ€ê¸° ì¤‘');
                }, 3000);
            });

            // Track mode changes
            const modeSelector = document.getElementById('modeSelector');
            modeSelector.addEventListener('change', () => {
                const modeName = getModeDisplayName(modeSelector.value);
                updateStatus(`ëª¨ë“œ ë³€ê²½: ${modeName}`);
                
                setTimeout(() => {
                    updateStatus('ëŒ€ê¸° ì¤‘');
                }, 2000);
            });

            // Track emoji selector changes
            const emojiSelector = document.getElementById('emojiSelector');
            emojiSelector.addEventListener('change', () => {
                updateStatus(`ì´ëª¨ì§€ ì„ íƒ: ${emojiSelector.value}`);
                
                setTimeout(() => {
                    updateStatus('ëŒ€ê¸° ì¤‘');
                }, 2000);
            });

            // Track shape selector changes
            const shapeSelector = document.getElementById('shapeSelector');
            shapeSelector.addEventListener('change', () => {
                const shapeName = getShapeDisplayName(shapeSelector.value);
                updateStatus(`ë„í˜• ì„ íƒ: ${shapeName}`);
                
                setTimeout(() => {
                    updateStatus('ëŒ€ê¸° ì¤‘');
                }, 2000);
            });

            // Track color changes
            const colorSelector = document.getElementById('colorSelector');
            colorSelector.addEventListener('change', () => {
                const colorName = getColorDisplayName(colorSelector.value);
                updateStatus(`ìƒ‰ìƒ ë³€ê²½: ${colorName}`);
                
                setTimeout(() => {
                    updateStatus('ëŒ€ê¸° ì¤‘');
                }, 2000);
            });

            // Track save action
            const saveButton = document.getElementById('saveButton');
            saveButton.addEventListener('click', () => {
                updateStatus('ì´ë¯¸ì§€ ì €ì¥ë¨');
                
                setTimeout(() => {
                    updateStatus('ëŒ€ê¸° ì¤‘');
                }, 3000);
            });

            // Track undo action
            const undoButton = document.getElementById('undoButton');
            undoButton.addEventListener('click', () => {
                updateStatus('ì‹¤í–‰ ì·¨ì†Œë¨');
                
                setTimeout(() => {
                    updateStatus('ëŒ€ê¸° ì¤‘');
                }, 2000);
            });
        }

        // Multi-language support functions
        function getLanguage() {
            // Priority: 1. localStorage, 2. browser language, 3. default 'en'
            const savedLang = localStorage.getItem('language');
            if (savedLang) return savedLang;

            const browserLang = navigator.language || navigator.userLanguage;
            if (browserLang.startsWith('ko')) return 'ko';
            
            return 'en';
        }

        function setLanguage(lang) {
            localStorage.setItem('language', lang);
            updateUILanguage();
        }

        function translate(key, params = {}) {
            const translations = {
                'ko': {
                    'fileOperations': 'íŒŒì¼ ì‘ì—…',
                    'pasteFromClipboard': 'í´ë¦½ë³´ë“œì—ì„œ ê°€ì ¸ì˜¤ê¸°',
                    'canvasSettings': 'ìº”ë²„ìŠ¤ ì„¤ì •',
                    'canvasMode': 'ìº”ë²„ìŠ¤ ëª¨ë“œ',
                    'singleImageMode': 'ì‹±ê¸€ ì´ë¯¸ì§€ í¸ì§‘',
                    'multiImageMode': 'ë¹ˆ ìº”ë²„ìŠ¤ (ë©€í‹° ì´ë¯¸ì§€)',
                    'backgroundColor': 'ë°°ê²½ìƒ‰',
                    'canvasSize': 'ìº”ë²„ìŠ¤ í¬ê¸°',
                    'size1920x1080': 'Full HD (1920Ã—1080)',
                    'size1280x720': 'HD (1280Ã—720)',
                    'size1200x800': 'ì›¹ í‘œì¤€ (1200Ã—800)',
                    'size800x600': 'í´ë˜ì‹ (800Ã—600)',
                    'sizeA4Landscape': 'A4 ê°€ë¡œ (297Ã—210mm)',
                    'sizeA4Portrait': 'A4 ì„¸ë¡œ (210Ã—297mm)',
                    'sizeCustom': 'ì‚¬ìš©ì ì •ì˜',
                    'apply': 'ì ìš©',
                    'white': 'í°ìƒ‰',
                    'lightGray': 'ì—°í•œ íšŒìƒ‰',
                    'gray': 'íšŒìƒ‰',
                    'darkGray': 'ì§™ì€ íšŒìƒ‰',
                    'transparent': 'íˆ¬ëª…',
                    'annotationMode': 'ì£¼ì„ ëª¨ë“œ',
                    'numberMode': 'ìˆ«ì ì…ë ¥ ëª¨ë“œ',
                    'shapeMode': 'ë„í˜• ëª¨ë“œ',
                    'textMode': 'í…ìŠ¤íŠ¸ ëª¨ë“œ',
                    'emojiMode': 'ì´ëª¨ì§€ ëª¨ë“œ',
                    'cropMode': 'í¬ë¡­ ëª¨ë“œ',
                    'style': 'ìŠ¤íƒ€ì¼',
                    'color': 'ìƒ‰ìƒ',
                    'red': 'ë¹¨ê°„ìƒ‰',
                    'orange': 'ì£¼í™©ìƒ‰',
                    'green': 'ë…¹ìƒ‰',
                    'blue': 'íŒŒë‘ìƒ‰',
                    'size': 'í¬ê¸°',
                    'lineWidth': 'êµµê¸°',
                    'thin': 'ì–‡ìŒ',
                    'normal': 'ë³´í†µ',
                    'thick': 'ë‘êº¼ì›€',
                    'shape': 'ëª¨ì–‘',
                    'rectangle': 'ì‚¬ê°í˜•',
                    'circle': 'ì›',
                    'arrow': 'í™”ì‚´í‘œ',
                    'fill': 'ì±„ìš°ê¸°',
                    'fillNone': 'í…Œë‘ë¦¬ë§Œ',
                    'fillSolid': 'ë‹¨ìƒ‰ ì±„ìš°ê¸°',
                    'fillBlur': 'íë¦¼ íš¨ê³¼',
                    'fillMosaic': 'ëª¨ìì´í¬',
                    'emojiType': 'ì´ëª¨ì§€ ì¢…ë¥˜',
                    'cropStyle': 'í¬ë¡­ ìŠ¤íƒ€ì¼',
                    'cropBasic': 'ê¸°ë³¸ í¬ë¡­',
                    'cropShadow': 'ê·¸ë¦¼ì íš¨ê³¼',
                    'cropRounded': 'ë‘¥ê·¼ ëª¨ì„œë¦¬',
                    'cropTorn': 'ì°¢ì–´ì§„ ì¢…ì´',
                    'cropCurtain': 'ê·¹ì¥ ì»¤íŠ¼',
                    'cropControls': 'í¬ë¡­ ì»¨íŠ¸ë¡¤',
                    'applyCrop': 'í¬ë¡­ ì ìš©',
                    'cancelCrop': 'í¬ë¡­ ì·¨ì†Œ',
                    'layers': 'ë ˆì´ì–´',
                    'backgroundLayer': 'ë°°ê²½ ì´ë¯¸ì§€',
                    'clearAllLayers': 'ëª¨ë“  ë ˆì´ì–´ ì§€ìš°ê¸°',
                    'cropInstruction': 'ë“œë˜ê·¸í•˜ì—¬ í¬ë¡­ ì˜ì—­ì„ ì„ íƒí•˜ì„¸ìš”',
                    'undo': 'ì‹¤í–‰ ì·¨ì†Œ',
                    'save': 'ì €ì¥í•˜ê¸°',
                    'toggleTheme': 'í…Œë§ˆ ë³€ê²½',
                    'language': 'ì–¸ì–´',
                    'releaseNotes': 'ë¦´ë¦¬ì¦ˆ ë…¸íŠ¸',
                    'codeLineRemover': 'ì½”ë“œ ë¼ì¸ ì œê±°ê¸°',
                    'legacyVersion': 'ë ˆê±°ì‹œ ë²„ì „',
                    'chromeExtension': 'Chrome í™•ì¥ í”„ë¡œê·¸ë¨',
                    'editImage': 'ì´ë¯¸ì§€ í¸ì§‘',
                    'imageSize': 'ì´ë¯¸ì§€ í¬ê¸°:',
                    'autoResize': 'ìë™ ë¦¬ì‚¬ì´ì¦ˆ (ê¸°ë³¸)',
                    'originalSize': 'ì›ë³¸',
                    'width300': 'ë„ˆë¹„ 300',
                    'width600': 'ë„ˆë¹„ 600',
                    'width900': 'ë„ˆë¹„ 900',
                    'scale30': 'ì›ë³¸ ëŒ€ë¹„ 30% ì¶•ì†Œ',
                    'scale50': 'ì›ë³¸ ëŒ€ë¹„ 50% ì¶•ì†Œ',
                    'scale70': 'ì›ë³¸ ëŒ€ë¹„ 70% ì¶•ì†Œ',
                    'uploadImagePrompt': 'AnnotateShot ì„œë¹„ìŠ¤ ì´ìš© ë°©ë²•\n1. ë²ˆí˜¸, ë„í˜•, í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•´ì•¼í•˜ëŠ” ì´ë¯¸ì§€ë¥¼ ë¶ˆëŸ¬ì˜¤ì„¸ìš”. í´ë¦½ë³´ë“œ ì´ë¯¸ì§€ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.\n2. ì•„ë¬´ê³³ì´ë‚˜ í´ë¦­í•´ë³´ì„¸ìš”.\n3. ì €ì¥ì´ í•„ìš”í•˜ë©´ ì €ì¥í•˜ê¸° ë²„íŠ¼ì„ ëˆŒëŸ¬ì„œ ë¡œì»¬ PCë¡œ ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í˜¹ì€ ì´ë¯¸ì§€ ìš°ì¸¡ í´ë¦­ í›„ ì´ë¯¸ì§€ ë³µì‚¬ë¥¼ í•˜ì…”ë„ ê´œì°®ìŠµë‹ˆë‹¤.',
                    'blankCanvasPrompt': 'ë¹ˆ ìº”ë²„ìŠ¤ ëª¨ë“œ (ë©€í‹° ì´ë¯¸ì§€)\n1. ë°°ê²½ìƒ‰ì„ ì„ íƒí•˜ì„¸ìš”.\n2. ì—¬ëŸ¬ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ì—¬ ë ˆì´ì–´ë¡œ êµ¬ì„±í•˜ì„¸ìš”.\n3. ê° ì´ë¯¸ì§€ë¥¼ ë“œë˜ê·¸í•˜ì—¬ ìœ„ì¹˜ë¥¼ ì¡°ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
                    'imageLoaded': 'ì´ë¯¸ì§€ ë¡œë“œë¨: {width} x {height}',
                    'imageLayerAdded': 'ì´ë¯¸ì§€ ë ˆì´ì–´ {layerNumber} ì¶”ê°€ë¨: {width} x {height}',
                    'mouseMovePrompt': 'ë§ˆìš°ìŠ¤ë¥¼ ì›€ì§ì—¬ë³´ì„¸ìš”',
                    'statusCoordinates': 'ì¢Œí‘œ: ({x}, {y})',
                    'statusOutsideCanvas': 'ìº”ë²„ìŠ¤ ì˜ì—­ ì™¸ë¶€',
                    'statusWaiting': 'ëŒ€ê¸° ì¤‘',
                    'statusModeChanged': 'ëª¨ë“œ ë³€ê²½: {modeName}',
                    'statusEmojiSelected': 'ì´ëª¨ì§€ ì„ íƒ: {emoji}',
                    'statusShapeSelected': 'ë„í˜• ì„ íƒ: {shapeName}',
                    'statusColorChanged': 'ìƒ‰ìƒ ë³€ê²½: {colorName}',
                    'statusImageSaved': 'ì´ë¯¸ì§€ ì €ì¥ë¨',
                    'statusUndo': 'ì‹¤í–‰ ì·¨ì†Œë¨',
                    'statusAdded': '{modeName} ì¶”ê°€ë¨: ({x}, {y})',
                    'cropTooSmall': 'í¬ë¡­ ì˜ì—­ì´ ë„ˆë¬´ ì‘ìŠµë‹ˆë‹¤ (ìµœì†Œ 10Ã—10 í”½ì…€)',
                    'cropSelected': 'í¬ë¡­ ì˜ì—­ì´ ì„ íƒë˜ì—ˆìŠµë‹ˆë‹¤. ìŠ¤íƒ€ì¼ì„ ì„ íƒí•˜ê³  ì ìš© ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.',
                    'cropApplied': 'í¬ë¡­ì´ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤',
                    'cropCancelled': 'í¬ë¡­ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤',
                    'enterText': 'í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”',
                    'textAdded': 'í…ìŠ¤íŠ¸ "{text}" ì¶”ê°€ë¨: ({x}, {y})',
                    'emojiAdded': 'ì´ëª¨ì§€ {emoji} ì¶”ê°€ë¨: ({x}, {y})'
                },
                'en': {
                    'fileOperations': 'File Operations',
                    'pasteFromClipboard': 'Paste from Clipboard',
                    'canvasSettings': 'Canvas Settings',
                    'canvasMode': 'Canvas Mode',
                    'singleImageMode': 'Single Image Edit',
                    'multiImageMode': 'Blank Canvas (Multi Image)',
                    'backgroundColor': 'Background Color',
                    'canvasSize': 'Canvas Size',
                    'size1920x1080': 'Full HD (1920Ã—1080)',
                    'size1280x720': 'HD (1280Ã—720)',
                    'size1200x800': 'Web Standard (1200Ã—800)',
                    'size800x600': 'Classic (800Ã—600)',
                    'sizeA4Landscape': 'A4 Landscape (297Ã—210mm)',
                    'sizeA4Portrait': 'A4 Portrait (210Ã—297mm)',
                    'sizeCustom': 'Custom',
                    'apply': 'Apply',
                    'white': 'White',
                    'lightGray': 'Light Gray',
                    'gray': 'Gray',
                    'darkGray': 'Dark Gray',
                    'transparent': 'Transparent',
                    'annotationMode': 'Annotation Mode',
                    'numberMode': 'Number Mode',
                    'shapeMode': 'Shape Mode',
                    'textMode': 'Text Mode',
                    'emojiMode': 'Emoji Mode',
                    'cropMode': 'Crop Mode',
                    'style': 'Style',
                    'color': 'Color',
                    'red': 'Red',
                    'orange': 'Orange',
                    'green': 'Green',
                    'blue': 'Blue',
                    'size': 'Size',
                    'lineWidth': 'Line Width',
                    'thin': 'Thin',
                    'normal': 'Normal',
                    'thick': 'Thick',
                    'shape': 'Shape',
                    'rectangle': 'Rectangle',
                    'circle': 'Circle',
                    'arrow': 'Arrow',
                    'fill': 'Fill',
                    'fillNone': 'Border Only',
                    'fillSolid': 'Solid Fill',
                    'fillBlur': 'Blur Effect',
                    'fillMosaic': 'Mosaic',
                    'emojiType': 'Emoji Type',
                    'cropStyle': 'Crop Style',
                    'cropBasic': 'Basic Crop',
                    'cropShadow': 'Shadow Effect',
                    'cropRounded': 'Rounded Corners',
                    'cropTorn': 'Torn Paper',
                    'cropCurtain': 'Theater Curtain',
                    'cropControls': 'Crop Controls',
                    'applyCrop': 'Apply Crop',
                    'cancelCrop': 'Cancel Crop',
                    'layers': 'Layers',
                    'backgroundLayer': 'Background Image',
                    'clearAllLayers': 'Clear All Layers',
                    'cropInstruction': 'Drag to select crop area',
                    'undo': 'Undo',
                    'redo': 'Redo',
                    'save': 'Save',
                    'toggleTheme': 'Toggle Theme',
                    'language': 'Language',
                    'releaseNotes': 'Release Notes',
                    'codeLineRemover': 'Code Line Remover',
                    'legacyVersion': 'Legacy Version',
                    'chromeExtension': 'Chrome Extension',
                    'editImage': 'Edit Image',
                    'imageSize': 'Image Size:',
                    'autoResize': 'Auto Resize (Default)',
                    'originalSize': 'Original',
                    'width300': 'Width 300',
                    'width600': 'Width 600',
                    'width900': 'Width 900',
                    'scale30': 'Scale 30%',
                    'scale50': 'Scale 50%',
                    'scale70': 'Scale 70%',
                    'uploadImagePrompt': 'How to use AnnotateShot\n1. Load an image that needs numbers, shapes, or text annotations. Clipboard images are supported.\n2. Click anywhere on the image.\n3. When you need to save, click the Save button to download to your local PC. You can also right-click the image and copy it.',
                    'blankCanvasPrompt': 'Blank Canvas Mode (Multi Image)\n1. Select a background color.\n2. Upload multiple images to compose as layers.\n3. Drag each image to adjust its position.',
                    'imageLoaded': 'Image loaded: {width} x {height}',
                    'imageLayerAdded': 'Image layer {layerNumber} added: {width} x {height}',
                    'mouseMovePrompt': 'Move your mouse',
                    'statusCoordinates': 'Coordinates: ({x}, {y})',
                    'statusOutsideCanvas': 'Outside canvas area',
                    'statusWaiting': 'Waiting',
                    'statusModeChanged': 'Mode changed: {modeName}',
                    'statusEmojiSelected': 'Emoji selected: {emoji}',
                    'statusShapeSelected': 'Shape selected: {shapeName}',
                    'statusColorChanged': 'Color changed: {colorName}',
                    'statusImageSaved': 'Image saved',
                    'statusUndo': 'Action undone',
                    'statusAdded': '{modeName} added at: ({x}, {y})',
                    'cropTooSmall': 'Crop area is too small (minimum 10Ã—10 pixels)',
                    'cropSelected': 'Crop area selected. Choose a style and click Apply.',
                    'cropApplied': 'Crop has been applied',
                    'cropCancelled': 'Crop has been cancelled',
                    'enterText': 'Enter text',
                    'textAdded': 'Text "{text}" added at: ({x}, {y})',
                    'emojiAdded': 'Emoji {emoji} added at: ({x}, {y})'
                }
            };

            const lang = getLanguage();
            let text = translations[lang]?.[key] || translations['en']?.[key] || key;
            
            // Replace parameters
            Object.keys(params).forEach(param => {
                text = text.replace(`{${param}}`, params[param]);
            });
            
            return text;
        }

        function updateUILanguage() {
            const lang = getLanguage();
            document.documentElement.lang = lang;
            
            document.querySelectorAll('[data-lang-key]').forEach(element => {
                const key = element.dataset.langKey;
                const translatedText = translate(key);
                
                // Handle special cases like prompt text with line breaks
                if (key === 'uploadImagePrompt') {
                    element.innerHTML = translatedText.replace(/\n/g, '<br>');
                } else {
                    element.textContent = translatedText;
                }
            });

            // Update language selector to reflect current language
            const languageSelector = document.getElementById('languageSelector');
            if (languageSelector) {
                languageSelector.value = lang;
            }
        }

        function getModeDisplayName(mode) {
            return translate(mode + 'Mode');
        }

        function getShapeDisplayName(shape) {
            return translate(shape);
        }

        function getColorDisplayName(color) {
            const colorMap = {
                '#FF0000': 'red',
                '#FF8000': 'orange',
                '#00FF00': 'green',
                '#0000FF': 'blue'
            };
            return translate(colorMap[color.toUpperCase()] || color);
        }

        // Initialize all functionality when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            initializeTheme();
            initializeSidebar();
            initializeLayerSidebar();
            initializeModeControls();
            initializeStatusLogging();
            updateCanvasContainer();
            
            // Initialize language selector
            const languageSelector = document.getElementById('languageSelector');
            languageSelector.addEventListener('change', (e) => {
                setLanguage(e.target.value);
            });

            // Set initial language
            updateUILanguage();
            
            // Ensure initial mode controls are properly displayed
            setTimeout(() => {
                updateControlsVisibility();
            }, 100);
            
            // Watch for canvas changes
            const canvas = document.getElementById('imageCanvas');
            const observer = new MutationObserver(updateCanvasContainer);
            observer.observe(canvas, { attributes: true, attributeFilter: ['width', 'height'] });
        });

        // ëª¨ë°”ì¼ ì „ìš© UI ì´ˆê¸°í™”
        function initializeMobileUI() {
            if (!isMobileDevice()) return; // ëª¨ë°”ì¼ì´ ì•„ë‹ˆë©´ ì‹¤í–‰í•˜ì§€ ì•ŠìŒ
            
            console.log('ëª¨ë°”ì¼ ì „ìš© UI ì´ˆê¸°í™” ì¤‘...');
            
            // í”Œë¡œíŒ… ì•¡ì…˜ ë²„íŠ¼ ì´ë²¤íŠ¸
            const fabImage = document.getElementById('fabImage');
            const fabSave = document.getElementById('fabSave');
            const fabUndo = document.getElementById('fabUndo');
            const fabMode = document.getElementById('fabMode');
            const mobileImageInput = document.getElementById('mobileImageInput');
            
            // ëª¨ë°”ì¼ ì´ë¯¸ì§€ ì—…ë¡œë“œ
            if (fabImage && mobileImageInput) {
                fabImage.addEventListener('click', () => {
                    console.log('ëª¨ë°”ì¼ ì´ë¯¸ì§€ ì—…ë¡œë“œ ë²„íŠ¼ í´ë¦­');
                    mobileImageInput.click();
                });
                
                mobileImageInput.addEventListener('change', (e) => {
                    const file = e.target.files[0];
                    if (file) {
                        console.log('ëª¨ë°”ì¼ì—ì„œ ì´ë¯¸ì§€ ì„ íƒë¨:', file.name);
                        loadImageFromFile(file);
                    }
                });
            }
            
            if (fabSave) fabSave.addEventListener('click', () => document.getElementById('saveButton').click());
            if (fabUndo) fabUndo.addEventListener('click', () => document.getElementById('undoButton').click());
            if (fabMode) fabMode.addEventListener('click', showMobileModePanel);
            
            // ëª¨ë°”ì¼ ì´ë¯¸ì§€ ë¡œë” í•¨ìˆ˜
            function loadImageFromFile(file) {
                if (!file.type.startsWith('image/')) {
                    console.error('ì´ë¯¸ì§€ íŒŒì¼ì´ ì•„ë‹™ë‹ˆë‹¤');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    const img = new Image();
                    img.onload = () => {
                        console.log('ëª¨ë°”ì¼ ì´ë¯¸ì§€ ë¡œë“œ ì™„ë£Œ:', img.width, 'x', img.height);
                        
                        // ì‹±ê¸€ ëª¨ë“œë¡œ ì „í™˜
                        document.getElementById('canvasModeSelector').value = 'single';
                        document.getElementById('canvasModeSelector').dispatchEvent(new Event('change'));
                        
                        // ì´ë¯¸ì§€ ì„¤ì •
                        if (typeof window.setCurrentImage === 'function') {
                            window.setCurrentImage(img);
                        } else {
                            // main.jsì˜ ê¸°ì¡´ ì´ë¯¸ì§€ ë¡œë”© ë¡œì§ ì‚¬ìš©
                            currentImage = img;
                            resizeAndDrawImage();
                        }
                        
                        // ì„±ê³µ í”¼ë“œë°±
                        showMobileMessage('ì´ë¯¸ì§€ê°€ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤', 'success');
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
            
            // ëª¨ë°”ì¼ ë©”ì‹œì§€ í‘œì‹œ
            function showMobileMessage(message, type = 'info') {
                // ê¸°ì¡´ ë©”ì‹œì§€ div ì‚¬ìš©
                const messageDiv = document.getElementById('message');
                if (messageDiv) {
                    messageDiv.textContent = message;
                    messageDiv.style.display = 'block';
                    messageDiv.className = type === 'success' ? 'success' : '';
                    
                    setTimeout(() => {
                        messageDiv.style.display = 'none';
                        messageDiv.className = '';
                    }, 3000);
                } else {
                    console.log('ëª¨ë°”ì¼ ë©”ì‹œì§€:', message);
                }
            }
            
            // ëª¨ë°”ì¼ íˆ´ë°” ì´ë²¤íŠ¸
            const mobileToolbar = document.querySelector('.mobile-toolbar');
            if (mobileToolbar) {
                mobileToolbar.addEventListener('click', (e) => {
                    if (e.target.classList.contains('toolbar-button')) {
                        const mode = e.target.dataset.mode;
                        if (mode) {
                            document.getElementById('modeSelector').value = mode;
                            document.getElementById('modeSelector').dispatchEvent(new Event('change'));
                            updateMobileToolbar();
                        }
                    }
                });
            }
            
            updateMobileToolbar();
            
            // ëª¨ë°”ì¼ì—ì„œ ë¦¬ì‚¬ì´ì¦ˆë¥¼ autoë¡œ ê¸°ë³¸ ì„¤ì •
            const resizeSelector = document.getElementById('resizeSelector');
            if (resizeSelector) {
                resizeSelector.value = 'auto';
                resizeSelector.dispatchEvent(new Event('change'));
                console.log('ëª¨ë°”ì¼ - ë¦¬ì‚¬ì´ì¦ˆ ëª¨ë“œë¥¼ autoë¡œ ì„¤ì •');
            }
        }
        
        function showMobileModePanel() {
            const panel = document.getElementById('mobileModePanel');
            const overlay = document.getElementById('mobileOverlay');
            if (panel && overlay) {
                panel.classList.add('show');
                overlay.classList.add('show');
            }
        }
        
        function hideMobileModePanel() {
            const panel = document.getElementById('mobileModePanel');
            const overlay = document.getElementById('mobileOverlay');
            if (panel && overlay) {
                panel.classList.remove('show');
                overlay.classList.remove('show');
            }
        }
        
        function updateMobileToolbar() {
            const buttons = document.querySelectorAll('.mobile-toolbar .toolbar-button');
            const currentMode = document.getElementById('modeSelector').value;
            
            buttons.forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.mode === currentMode) {
                    btn.classList.add('active');
                }
            });
        }

        // ëª¨ë°”ì¼ ê°ì§€ í•¨ìˆ˜ (ì¤‘ë³µ ë°©ì§€)
        function isMobileDevice() {
            const userAgent = navigator.userAgent.toLowerCase();
            const mobileKeywords = [
                'android', 'webos', 'iphone', 'ipad', 'ipod', 
                'blackberry', 'windows phone', 'mobile', 'opera mini'
            ];
            return mobileKeywords.some(keyword => userAgent.includes(keyword));
        }

        // DOMContentLoadedì— ëª¨ë°”ì¼ UI ì´ˆê¸°í™” ì¶”ê°€
        document.addEventListener('DOMContentLoaded', () => {
            // ê¸°ì¡´ ì´ˆê¸°í™”...
            initializeMobileUI(); // ëª¨ë°”ì¼ UI ì´ˆê¸°í™” ì¶”ê°€
        });
    </script>

    <!-- ëª¨ë°”ì¼ ì „ìš© UI ì»´í¬ë„ŒíŠ¸ë“¤ -->
    <div class="mobile-only" style="display: none;">
        <!-- í”Œë¡œíŒ… ì•¡ì…˜ ë²„íŠ¼ë“¤ -->
        <div class="floating-action-buttons">
            <button class="fab" id="fabImage" title="ì´ë¯¸ì§€ ì—…ë¡œë“œ">
                <span class="material-icons">add_photo_alternate</span>
            </button>
            <button class="fab save" id="fabSave" title="ì €ì¥">
                <span class="material-icons">save</span>
            </button>
            <button class="fab undo" id="fabUndo" title="ë˜ëŒë¦¬ê¸°">
                <span class="material-icons">undo</span>
            </button>
            <button class="fab" id="fabMode" title="ëª¨ë“œ ë³€ê²½">
                <span class="material-icons">tune</span>
            </button>
        </div>
        
        <!-- ëª¨ë°”ì¼ ì „ìš© ìˆ¨ê²¨ì§„ íŒŒì¼ ì…ë ¥ -->
        <input type="file" id="mobileImageInput" accept="image/*" capture="environment" style="display: none;">
    </div>

        <!-- ëª¨ë°”ì¼ í•˜ë‹¨ íˆ´ë°” -->
        <div class="mobile-toolbar">
            <button class="toolbar-button" data-mode="number">
                <span class="material-icons">format_list_numbered</span>
                <span>ìˆ«ì</span>
            </button>
            <button class="toolbar-button" data-mode="shape">
                <span class="material-icons">crop_square</span>
                <span>ë„í˜•</span>
            </button>
            <button class="toolbar-button" data-mode="text">
                <span class="material-icons">text_fields</span>
                <span>í…ìŠ¤íŠ¸</span>
            </button>
            <button class="toolbar-button" data-mode="emoji">
                <span class="material-icons">sentiment_satisfied</span>
                <span>ì´ëª¨ì§€</span>
            </button>
        </div>

        <!-- ëª¨ë°”ì¼ ëª¨ë“œ ì„ íƒ íŒ¨ë„ -->
        <div class="mobile-mode-panel" id="mobileModePanel">
            <h3 style="margin-top: 0; text-align: center;">í¸ì§‘ ëª¨ë“œ ì„ íƒ</h3>
            <div class="mode-grid">
                <div class="mode-card" onclick="selectMobileMode('number')">
                    <span class="material-icons">format_list_numbered</span>
                    <div class="mode-name">ìˆ«ì ëª¨ë“œ</div>
                </div>
                <div class="mode-card" onclick="selectMobileMode('shape')">
                    <span class="material-icons">crop_square</span>
                    <div class="mode-name">ë„í˜• ëª¨ë“œ</div>
                </div>
                <div class="mode-card" onclick="selectMobileMode('text')">
                    <span class="material-icons">text_fields</span>
                    <div class="mode-name">í…ìŠ¤íŠ¸ ëª¨ë“œ</div>
                </div>
                <div class="mode-card" onclick="selectMobileMode('emoji')">
                    <span class="material-icons">sentiment_satisfied</span>
                    <div class="mode-name">ì´ëª¨ì§€ ëª¨ë“œ</div>
                </div>
            </div>
            <button onclick="hideMobileModePanel()" style="margin-top: 1.5rem; width: 100%; padding: 1rem; background-color: var(--muted); border: none; border-radius: 8px; color: var(--foreground); font-size: 1rem;">ë‹«ê¸°</button>
        </div>
    </div>

    <script>
        function selectMobileMode(mode) {
            document.getElementById('modeSelector').value = mode;
            document.getElementById('modeSelector').dispatchEvent(new Event('change'));
            hideMobileModePanel();
            updateMobileToolbar();
        }

        // ëª¨ë°”ì¼ ê¸°ê¸°ì—ì„œë§Œ ëª¨ë°”ì¼ UI í‘œì‹œ
        if (isMobileDevice() || localStorage.getItem('dev-force-mobile') === 'true' || new URLSearchParams(window.location.search).get('mobile') === 'true') {
            document.querySelector('.mobile-only').style.display = 'block';
            console.log('ëª¨ë°”ì¼ UI ì»´í¬ë„ŒíŠ¸ í™œì„±í™”');
        }

        // ê°œë°œìš© ë””ë²„ê·¸ ì •ë³´ (ì½˜ì†”ì—ì„œ í™•ì¸)
        console.log('=== AnnotateShot ëª¨ë°”ì¼ ë””ë²„ê·¸ ì •ë³´ ===');
        console.log('User Agent:', navigator.userAgent);
        console.log('ëª¨ë°”ì¼ ê°ì§€:', isMobileDevice());
        console.log('ê°•ì œ ëª¨ë°”ì¼ ëª¨ë“œ:', localStorage.getItem('dev-force-mobile') === 'true');
        console.log('URL ëª¨ë°”ì¼ ëª¨ë“œ:', new URLSearchParams(window.location.search).get('mobile') === 'true');
        console.log('ì ìš©ëœ í´ë˜ìŠ¤:', document.body.className);
        console.log('===');
        console.log('í…ŒìŠ¤íŠ¸ ë°©ë²•:');
        console.log('1. toggleMobileMode() - ëª¨ë°”ì¼/ë°ìŠ¤í¬í†± ëª¨ë“œ ì „í™˜');
        console.log('2. ?mobile=true íŒŒë¼ë¯¸í„°ë¡œ URL ì ‘ì†');
        console.log('================================');
    </script>

</body>
</html>